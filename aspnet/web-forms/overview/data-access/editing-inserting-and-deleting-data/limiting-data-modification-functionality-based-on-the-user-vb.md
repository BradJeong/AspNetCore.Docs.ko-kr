---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
title: 사용자 (VB)에 따라 데이터 수정 기능을 제한 | Microsoft Docs
author: rick-anderson
description: 사용자가 데이터를 편집할 수 있는 웹 응용 프로그램을 다른 사용자 계정에 다른 데이터 편집 권한을 가질 수 있습니다. 이 자습서에서는 살펴봅니다 어떻게 t...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 9dc264a6-feb8-474b-8b91-008c50708065
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
msc.type: authoredcontent
ms.openlocfilehash: eccb8e114e0ecf772680a2e5b36a761736cf8025
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30887875"
---
<a name="limiting-data-modification-functionality-based-on-the-user-vb"></a><span data-ttu-id="dceb5-104">사용자 (VB)에 따라 데이터 수정 기능 제한</span><span class="sxs-lookup"><span data-stu-id="dceb5-104">Limiting Data Modification Functionality Based on the User (VB)</span></span>
====================
<span data-ttu-id="dceb5-105">으로 [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="dceb5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="dceb5-106">[샘플 앱을 다운로드](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) 또는 [PDF 다운로드](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="dceb5-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span></span>

> <span data-ttu-id="dceb5-107">사용자가 데이터를 편집할 수 있는 웹 응용 프로그램을 다른 사용자 계정에 다른 데이터 편집 권한을 가질 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="dceb5-108">이 자습서에서는 방문한 사용자 기반 데이터 수정 기능을 동적으로 조정 하는 방법을 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>


## <a name="introduction"></a><span data-ttu-id="dceb5-109">소개</span><span class="sxs-lookup"><span data-stu-id="dceb5-109">Introduction</span></span>

<span data-ttu-id="dceb5-110">사용자 계정을 지원 하 고 다양 한 옵션, 보고서 및 로그인된 한 사용자를 기반으로 기능을 제공 하는 웹 응용 프로그램의 수입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="dceb5-111">예를 들어이 자습서에서 하고자 할 수 있습니다 아마도-자신의 회사 이름, 공급 업체 정보 함께 제품-이름 및 포장 단위에 대 한 사이트 및 업데이트 일반 정보에 로그온 하려면 공급자 회사에서 사용자가 허용 합니다. 주소, 담당자의 정보 및 등입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="dceb5-112">또한 다음에 로그온 하 고 주식형, 단위 수준에서 순서를 변경 하 고 등와 같은 제품 정보를 업데이트할 수 있도록 회사에서 사용자를 위한 일부 사용자 계정을 포함 하도록는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="dceb5-113">웹 응용 프로그램 (하지 로그온 사람)를 방문 하 여 익명 사용자를 통해서도 수 있지만 데이터를 보기만 하도록 제한 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="dceb5-114">이 사용자 계정 시스템 원위치에서에서 웹 컨트롤 데이터 삽입, 편집 및 삭제는 현재 로그온된 한 사용자에 대 한 적절 한 기능을 제공 하는 ASP.NET 페이지에서 원하는 것 म 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="dceb5-115">이 자습서에서는 방문한 사용자 기반 데이터 수정 기능을 동적으로 조정 하는 방법을 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="dceb5-116">특히, 공급자가 제공 하는 제품을 나열 하는 GridView 함께 편집 가능한 DetailsView에 공급 업체 정보를 표시 하는 페이지를 만들겠습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="dceb5-117">저희 회사는 페이지를 방문 하는 사용자 인 경우 다음을 수행할 수 있습니다: 모든 공급 업체의 정보 보기 해당 주소; 편집 공급자가 제공 하는 모든 제품에 대 한 정보를 편집 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="dceb5-118">그러나 특정 회사에서 사용자가을 하는 경우 수행할 수 있습니다만 보고 하 고 자신의 주소 정보를 편집 하 고, 중단으로 표시 되지 않은 해당 제품에만 편집할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>


<span data-ttu-id="dceb5-119">[![저희 회사에서 사용자는 모든 공급 업체의 정보를 편집할 수 있습니다.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span></span>

<span data-ttu-id="dceb5-120">**그림 1**: s Our 회사 수 편집 Any 공급 업체 정보에서에서 사용자 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span></span>


<span data-ttu-id="dceb5-121">[![사용자가 특정 공급 업체 수 있는 유일한 보기 및 편집의 정보는](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span></span>

<span data-ttu-id="dceb5-122">**그림 2**: 특정 공급 업체 수만 보기 및 편집의 정보는 사용자 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span></span>


<span data-ttu-id="dceb5-123">Let s가 시작 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="dceb5-124">ASP.NET 2.0 s 멤버 자격 시스템 만들고 관리 하 고 사용자 계정 확인 하기 위한 표준화 되 고 확장 가능한 플랫폼을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="dceb5-125">이 자습서의 범위를 벗어나는 멤버 자격 시스템 검사 결과 이므로,이 자습서에서는 대신 "fakes" 멤버 자격 저희 회사 또는 특정 공급 업체에서 지 여부를 선택 하는 익명 방문자를 허용 하 여 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="dceb5-126">멤버 자격에 대 한 자세한에 대 한 참조 내 [ASP.NET 2.0 검사 s 멤버 자격, 역할 및 프로필](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) 계열 문서입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>


## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="dceb5-127">1 단계: 사용자가 자신의 액세스 권한을 지정할 수 있도록</span><span class="sxs-lookup"><span data-stu-id="dceb5-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="dceb5-128">실제 웹 응용 프로그램에서는 회사에 대해 또는 특정 공급 업체에 대 한 작업 하 고 사용자가 사이트에 로그온 한 후이 정보는 ASP.NET 페이지에서 프로그래밍 방식으로 액세스할 수는 여부를 사용자의 계정 정보를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="dceb5-129">사용자 계정 정보 프로 파일 시스템을 통해 또는 일부 사용자 지정 방법으로 ASP.NET 2.0의 역할 시스템을 통해이 정보를 캡처할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="dceb5-130">이 자습서의 목표 조정 로그온된 한 사용자에 따라 데이터 수정 기능을 보여 주기 위해이 고 쇼케이스 ASP.NET 2.0 s 멤버 자격, 역할 및 프로 파일 시스템으로 다루지는지 않습니다, 되므로에서는 매우 간단 하 게 메커니즘을 결정 하는 기능 페이지-있는 사용자 수를 보고 하는 공급 업체 정보 하거나, 무엇을 편집할 수 해야 하는 경우 나타낼 수 DropDownList를 방문 하는 사용자에 대 한 특정 공급 업체의 정보를 볼 수 있으며 편집 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="dceb5-131">사용자는이 확인 및 모든 공급 업체 정보 (기본값)를 편집할 수 그녀 나타내면 그녀 수 모든 공급 업체를 통해 페이지, 모든 공급 업체의 주소 정보를 편집한 이름과 포장 선택한 공급자가 제공 하는 모든 제품에 대 한 단위를 편집 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="dceb5-132">그러나 사용자만 볼 수 있습니다 및 이름 및 해당 제품에 대 한 단위 정보 당 개수 별 영역의 특정 공급 업체, 다음 그녀 수만 해당 공급자에 대 한 세부 정보 및 제품을 볼 수만 업데이트 되었음을 나타내는 경우 *하지* 중단 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="dceb5-133">이 자습서의 첫 번째 단계, 하는 것이 DropDownList를 만들고 시스템에 공급 업체를 채웁니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="dceb5-134">열기는 `UserLevelAccess.aspx` 페이지에 `EditInsertDelete` 폴더를 DropDownList를 추가 인 `ID` 속성이로 설정 되어 `Suppliers`, 라는 새 ObjectDataSource이이 DropDownList 바인딩할 `AllSuppliersDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>


<span data-ttu-id="dceb5-135">[![AllSuppliersDataSource 라는 새 ObjectDataSource 만들기](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span></span>

<span data-ttu-id="dceb5-136">**그림 3**: 명명 된 새 ObjectDataSource 만드는 `AllSuppliersDataSource` ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span></span>


<span data-ttu-id="dceb5-137">모든 공급자를 포함 하도록이 DropDownList 할 것 이므로 구성 ObjectDataSource를 호출 하 여 `SuppliersBLL` s 클래스 `GetSuppliers()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="dceb5-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="dceb5-138">또한 되도록 ObjectDataSource s `Update()` 메서드가 매핑되는 `SuppliersBLL` s 클래스 `UpdateSupplierAddress` 메서드를이 ObjectDataSource로도 사용해 2 단계에서에서 추가할 예정이 니 DetailsView 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="dceb5-139">ObjectDataSource 마법사를 완료 한 후 구성 하 여 다음 단계를 완료 된 `Suppliers` DropDownList 표시 되도록는 `CompanyName` 사용 하 여 데이터 필드는 `SupplierID` 데이터 필드를 각각에 대 한 값으로 `ListItem`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>


<span data-ttu-id="dceb5-140">[![Suppliers DropDownList CompanyName 및 SupplierID 데이터 필드를 사용 하도록 구성](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span></span>

<span data-ttu-id="dceb5-141">**그림 4**: 구성에서 `Suppliers` DropDownList를 사용 하 여는 `CompanyName` 및 `SupplierID` 데이터 필드 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span></span>


<span data-ttu-id="dceb5-142">이 시점에서 드롭다운 목록에는 데이터베이스에 공급 업체의 회사 이름을 나열합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="dceb5-143">그러나 또한 해야 드롭다운 목록에 "Show/편집 모든 공급 업체" 옵션을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="dceb5-144">이를 위해 설정 된 `Suppliers` DropDownList s `AppendDataBoundItems` 속성을 `true` 다음 추가 `ListItem` 인 `Text` "모든 공급 업체 보기/편집"이 고 값이 속성은 `-1`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="dceb5-145">추가할 수 있습니다는 디자이너를 사용 하거나 선언 태그를 통해 직접 DropDownList s에 있는 줄임표를 클릭 하 고 속성 창으로 이동 하 여 `Items` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="dceb5-146">다시 참조는 [ *마스터/세부 정보 필터링 된 정도 DropDownList* ](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) 자습서에 대 한 자세한 내용은 데이터 바인딩된 DropDownList 모두 선택 항목을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>


<span data-ttu-id="dceb5-147">이후에 `AppendDataBoundItems` 속성이 설정 되어 및 `ListItem` 추가 DropDownList s 선언 태그 같아야 합니다:</span><span class="sxs-lookup"><span data-stu-id="dceb5-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample1.aspx)]

<span data-ttu-id="dceb5-148">그림 5에서는 브라우저를 통해 볼 때 현재 진행률의 스크린 샷을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>


<span data-ttu-id="dceb5-149">[![각 공급 업체에 대 한 개와 모든 ListItem Suppliers DropDownList는 표시를 포함](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span></span>

<span data-ttu-id="dceb5-150">**그림 5**:는 `Suppliers` DropDownList를 모두 표시 포함 `ListItem`, 플러스 한 각 공급 업체에 대 한 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span></span>


<span data-ttu-id="dceb5-151">사용자의 선택 영역을 변경한 후에 즉시 대시보드 사용자 인터페이스를 업데이트 하고자 하므로 설정는 `Suppliers` DropDownList s `AutoPostBack` 속성을 `true`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="dceb5-152">2 단계에서에서 DropDownList 선택을 기반으로 신뢰에 대 한 정보를 나타내는 DetailsView 컨트롤을 만들겠습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="dceb5-153">그런 다음 3 단계에서는 만들어이 DropDownList s에 대 한 이벤트 처리기 `SelectedIndexChanged` DetailsView를 적절 한 공급 업체 정보에 바인딩하는 코드는 선택한 공급자에 따라 추가 이벤트입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="dceb5-154">2 단계: DetailsView 컨트롤 추가</span><span class="sxs-lookup"><span data-stu-id="dceb5-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="dceb5-155">S DetailsView를 사용 하 여 공급 업체 정보를 표시할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="dceb5-156">모든 공급자를 편집 하 고 볼 수 있는 사용자에 대 한 DetailsView는 지원 페이징, 사용자가 한 번에 공급 업체 정보 하나의 레코드를 단계별로 실행할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="dceb5-157">그러나 사용자를 특정 공급 업체에 대 한 작동 DetailsView 해당 특정 공급 업체만 s 정보가 표시 됩니다 않으며 페이징 인터페이스에 포함 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="dceb5-158">두 경우 모두 DetailsView 사용자 공급 업체의 주소, city 및 country 필드를 편집할 수 있도록 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="dceb5-159">DetailsView 아래에 있는 페이지에 추가 `Suppliers` DropDownList를 설정의 `ID` 속성을 `SupplierDetails`에 바인딩할는 `AllSuppliersDataSource` ObjectDataSource 이전 단계에서 만든 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="dceb5-160">다음으로 DetailsView s 스마트 태그에서 페이징 사용 및 편집 사용 확인란을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="dceb5-161">T don 스마트 DetailsView s에서 편집 사용 옵션을 참조 하는 경우 여기에 태그 s ObjectDataSource s 매핑되지 않은 `Update()` 메서드는 `SuppliersBLL` s 클래스 `UpdateSupplierAddress` 메서드.</span><span class="sxs-lookup"><span data-stu-id="dceb5-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="dceb5-162">잠시 뒤로 돌아가이 구성을 변경, 지나면 편집 사용 옵션 DetailsView s 스마트 태그에 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>


<span data-ttu-id="dceb5-163">이후는 `SuppliersBLL` s 클래스 `UpdateSupplierAddress` 메서드만는 4 개의 매개 변수- `supplierID`, `address`, `city`, 및 `country` -DetailsView의 BoundFields 수정 하는 `CompanyName` 및 `Phone` BoundFields은 읽기 전용입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="dceb5-164">또한 제거는 `SupplierID` BoundField 모두 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="dceb5-165">마지막으로 `AllSuppliersDataSource` ObjectDataSource에 현재 있는 해당 `OldValuesParameterFormatString` 속성이로 설정 `original_{0}`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="dceb5-166">선언적 구문 모두에서이 속성 설정을 제거 하거나 기본 값으로 설정 하 `{0}`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="dceb5-167">구성한 후의 `SupplierDetails` DetailsView 및 `AllSuppliersDataSource` ObjectDataSource를 다음과 같은 선언적 태그가 있는 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample2.aspx)]

<span data-ttu-id="dceb5-168">DetailsView 통해 페이징할 수는 시점에서 및 선택한 공급 업체의 주소 정보를 업데이트할 수에서 선택한 항목에 관계 없이 `Suppliers` DropDownList (그림 6 참조).</span><span class="sxs-lookup"><span data-stu-id="dceb5-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>


<span data-ttu-id="dceb5-169">[![모든 공급 업체 정보를 볼 수 있으며 해당 주소를 업데이트](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span></span>

<span data-ttu-id="dceb5-170">**그림 6**: Any 공급 업체 정보를 볼 수, 하 고 해당 주소를 업데이트 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span></span>


## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="dceb5-171">3 단계: 선택된 협력 업체의 정보만 표시</span><span class="sxs-lookup"><span data-stu-id="dceb5-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="dceb5-172">현재 가격 페이지에서 선택한 특정 공급 업체 여부에 관계 없이 모든 공급자에 대 한 정보를 표시 된 `Suppliers` DropDownList 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="dceb5-173">선택한 공급자에 대 한 공급 업체 정보만 표시 하기 위해 다른 ObjectDataSource 특정 공급 업체에 대 한 정보를 검색 하는 가격 페이지에 추가 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="dceb5-174">이름을 지정 하 고 페이지와 새 ObjectDataSource 추가 `SingleSupplierDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="dceb5-175">스마트 태그를 데이터 소스 구성 링크를 클릭 하 고 사용 하 여는 `SuppliersBLL` s 클래스 `GetSupplierBySupplierID(supplierID)` 메서드.</span><span class="sxs-lookup"><span data-stu-id="dceb5-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="dceb5-176">과 마찬가지로 `AllSuppliersDataSource` ObjectDataSource를가 `SingleSupplierDataSource` ObjectDataSource s `Update()` 메서드 매핑할는 `SuppliersBLL` s 클래스 `UpdateSupplierAddress` 메서드.</span><span class="sxs-lookup"><span data-stu-id="dceb5-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>


<span data-ttu-id="dceb5-177">[![SingleSupplierDataSource ObjectDataSource GetSupplierBySupplierID(supplierID) 메서드를 사용 하도록 구성](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span></span>

<span data-ttu-id="dceb5-178">**그림 7**: 구성에서 `SingleSupplierDataSource` 사용할 ObjectDataSource는 `GetSupplierBySupplierID(supplierID)` 메서드 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span></span>


<span data-ttu-id="dceb5-179">에 대 한 매개 변수 소스를 지정 하 라는 메시지가 다시 우리는 다음으로 `GetSupplierBySupplierID(supplierID)` s 메서드에 `supplierID` 입력된 매개 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="dceb5-180">사용 하 여 드롭다운 목록에서 선택한 공급자에 대 한 정보를 표시 하는 데는 `Suppliers` DropDownList의 `SelectedValue` 매개 변수 소스로 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>


<span data-ttu-id="dceb5-181">[![매개 변수 소스 supplierID로 Suppliers DropDownList를 사용 하 여](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span></span>

<span data-ttu-id="dceb5-182">**그림 8**: 사용 된 `Suppliers` 으로 DropDownList는 `supplierID` 매개 변수 소스 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span></span>


<span data-ttu-id="dceb5-183">추가 된이 두 번째 ObjectDataSource를 사용 하더라도 DetailsView 컨트롤은 항상 사용 하도록 구성 현재는 `AllSuppliersDataSource` ObjectDataSource 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="dceb5-184">필요에 따라 DetailsView에 사용 되는 데이터 소스를 조정 하는 논리를 추가 하는 `Suppliers` DropDownList 항목을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="dceb5-185">이를 위해 만들기는 `SelectedIndexChanged` Suppliers 드롭다운 목록에 대 한 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="dceb5-186">이 디자이너에 필요한 DropDownList를 두 번 클릭 하 여 가장 쉽게 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="dceb5-187">이 이벤트 처리기 사용 하 여 데이터 원본을 확인 하 고 데이터 DetailsView 다시 바인딩해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="dceb5-188">이 작업은 다음 코드와 함께 수행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-188">This is accomplished with the following code:</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample3.vb)]

<span data-ttu-id="dceb5-189">이벤트 처리기는 "모든 공급 업체 보기/편집" 옵션이 선택 되어 있는지 여부를 확인 하 여 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="dceb5-190">설정에 있는 경우는 `SupplierDetails` DetailsView s `DataSourceID` 를 `AllSuppliersDataSource` 공급자 집합의 첫 번째 레코드를 설정 하 여 사용자를 반환 하 고는 `PageIndex` 속성을 0입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="dceb5-191">그러나 사용자가 특정 공급 업체에서에서 선택한 DetailsView의 DropDownList 경우 `DataSourceID` 에 할당 된 `SingleSuppliersDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="dceb5-192">데이터에 관계 없이 사용 소스는 `SuppliersDetails` 모드는 읽기 전용 모드로 되돌아갑니다 및 데이터를 호출 하 여 다시 DetailsView에 바인딩할는 `SuppliersDetails` 컨트롤의 `DataBind()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="dceb5-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="dceb5-193">이 이벤트 처리기 위치에 DetailsView 컨트롤 이제 표시 선택한 공급 업체는 쿼리에서 모든 공급 업체 중 확인할 수 있습니다 페이징 인터페이스를 통해 "모든 공급 업체 보기/편집" 옵션을 선택한 경우가 아니면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="dceb5-194">그림 9 "표시/편집 모든 공급 업체" 옵션을 선택 합니다; 페이지를 보여 줍니다. 사용자가 방문 하 고 모든 공급 업체를 업데이트할 수 있도록 페이징 인터페이스 있는지 note 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="dceb5-195">그림 10 선택한 Ma 트레이 공급 업체와 페이지를 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="dceb5-196">만 Ma 트레이의 정보는 볼 수 있는 편집 가능한이 경우.</span><span class="sxs-lookup"><span data-stu-id="dceb5-196">Only Ma Maison s information is viewable and editable in this case.</span></span>


<span data-ttu-id="dceb5-197">[![모든 공급 업체 정보 보기 및 편집](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span></span>

<span data-ttu-id="dceb5-198">**그림 9**: 모든 공급 업체 정보를 볼 수 있습니다 및 편집한 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span></span>


<span data-ttu-id="dceb5-199">[![선택한 공급자의 정보만 확인 및 편집할 수](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span></span>

<span data-ttu-id="dceb5-200">**그림 10**: 선택한 공급자의 정보로 보기 및 편집 된 될 수 있습니다 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span></span>


> [!NOTE]
> <span data-ttu-id="dceb5-201">이 자습서에서는 DropDownList와 DetailsView 제어 s `EnableViewState` 으로 설정 되어 있어야 `true` (기본값) 때문에 DropDownList s `SelectedIndex` 및 DetailsView의 `DataSourceID` 게시할 s 속성 변경 내용을 저장 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>


## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="dceb5-202">편집 가능한 GridView에 공급 업체 제품을 나열 하는 4 단계:</span><span class="sxs-lookup"><span data-stu-id="dceb5-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="dceb5-203">전체 DetailsView와 다음 단계는 선택한 공급자가 제공 하는 해당 제품을 나열 하는 편집 가능한 GridView를 포함 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="dceb5-204">이 GridView에만 편집할 수 있도록 해야는 `ProductName` 및 `QuantityPerUnit` 필드입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="dceb5-205">또한 페이지를 방문 하는 사용자를 특정 공급 업체에서 경우만 허용 해야 해당 제품에 대 한 업데이트 *하지* 중단 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="dceb5-206">먼저의 오버 로드를 추가 해야이를 위해는 `ProductsBLL` s 클래스 `UpdateProducts` 메서드는 수행 하는 테이블만 `ProductID`, `ProductName`, 및 `QuantityPerUnit` 입력으로 필드입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="dceb5-207">에서는 다양 한 자습서에서는 미리이 프로세스를 진행 하면서 했습니다 사용에 추가 해야 하는 코드을 여기에서 확인 하는 s `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="dceb5-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample4.vb)]

<span data-ttu-id="dceb5-208">이 오버 로드를 가진 만들어지면 GridView 컨트롤 및 해당 관련된 ObjectDataSource를 추가 하려면 준비 된 것입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="dceb5-209">페이지에는 새 GridView 추가 설정, 해당 `ID` 속성을 `ProductsBySupplier`, 라는 새 ObjectDataSource를 사용 하도록 구성 하 고 `ProductsBySupplierDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="dceb5-210">선택한 공급자가 해당 제품을 나열 하려면이 GridView 할 것 이므로 사용 된 `ProductsBLL` s 클래스 `GetProductsBySupplierID(supplierID)` 메서드.</span><span class="sxs-lookup"><span data-stu-id="dceb5-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="dceb5-211">또한 매핑할는 `Update()` 메서드를 새 `UpdateProduct` 방금 만든 오버 로드 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>


<span data-ttu-id="dceb5-212">[![ObjectDataSource 방금 만든 UpdateProduct 오버 로드를 사용 하도록 구성](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span></span>

<span data-ttu-id="dceb5-213">**그림 11**: 구성에 사용 하 여 ObjectDataSource는 `UpdateProduct` 방금 만든 오버 로드 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span></span>


<span data-ttu-id="dceb5-214">에 대 한 매개 변수 소스를 선택 하 라는 메시지가 다시 우리는 `GetProductsBySupplierID(supplierID)` s 메서드에 `supplierID` 입력된 매개 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="dceb5-215">사용 하 여 DetailsView에서 선택한 공급자에 대 한 제품을 표시 하는 데는 `SuppliersDetails` DetailsView 컨트롤의 `SelectedValue` 매개 변수 소스로 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>


<span data-ttu-id="dceb5-216">[![매개 변수 소스로 SuppliersDetails DetailsView의 SelectedValue 속성을 사용 하 여](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span></span>

<span data-ttu-id="dceb5-217">**그림 12**: 사용 된 `SuppliersDetails` DetailsView s `SelectedValue` 매개 변수 소스로 속성 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span></span>


<span data-ttu-id="dceb5-218">GridView 필드를 제외 하 고 모두 제거 GridView 돌아가 `ProductName`, `QuantityPerUnit`, 및 `Discontinued`표시는 `Discontinued` CheckBoxField 읽기 전용으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="dceb5-219">또한 GridView s 스마트 태그에서 편집 사용 옵션을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="dceb5-220">이러한 변경 내용을 적용 된 GridView 및 ObjectDataSource에 대 한 선언적 태그는 다음과 같이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample5.aspx)]

<span data-ttu-id="dceb5-221">이 이전 ObjectDataSources이 하나의 s와 마찬가지로 `OldValuesParameterFormatString` 속성이 `original_{0}`, s 제품 이름 또는 단위당 수량을 업데이트 하려고 할 때 문제가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="dceb5-222">선언적 구문에서이 속성을 완전히 제거 하거나 해당 기본값으로 설정 `{0}`합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="dceb5-223">이 구성이 완료 가격 페이지 이제 제품이 나열 GridView에서 선택한 공급자가 제공 (그림 13 참조).</span><span class="sxs-lookup"><span data-stu-id="dceb5-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="dceb5-224">현재 *모든*의 제품 이름 또는 포장 단위를 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="dceb5-225">그러나 이러한 기능은 특정 공급 업체와 연결 된 사용자에 대해 지원 되지 않는 제품을 금지 수 있도록이 페이지 논리를 업데이트 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="dceb5-226">5 단계에서에서 마지막 요소가 해결할 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-226">We'll tackle this final piece in Step 5.</span></span>


<span data-ttu-id="dceb5-227">[![선택한 공급자가 제공 하는 제품 표시](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span></span>

<span data-ttu-id="dceb5-228">**그림 13**: 선택한 공급 업체에서 제공 되는 제품 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="dceb5-229">이 편집 가능한 GridView가 추가 된 `Suppliers` DropDownList의 `SelectedIndexChanged` GridView 읽기 전용 상태로 되돌리려면 이벤트 처리기를 업데이트 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="dceb5-230">그렇지 않으면 다른 공급 업체가 제공한 중간에 제품 정보를 편집을 선택 하면 해당 인덱스가 새 공급 업체에 대 한 GridView에 편집 가능한 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="dceb5-231">이 방지 하려면 GridView s를 설정 하기만 `EditIndex` 속성을 `-1` 에 `SelectedIndexChanged` 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>


<span data-ttu-id="dceb5-232">또한는 것이 중요 s 뷰 상태 수 GridView (기본 동작)을 사용할 수 있는지 생각해 보세요.</span><span class="sxs-lookup"><span data-stu-id="dceb5-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="dceb5-233">GridView s를 설정 하면 `EnableViewState` 속성을 `false`, 위험을 실수로 삭제 하거나 편집을 기록 하는 동시 사용자가 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="dceb5-234">참조 [경고: 동시성 문제가 있는 ASP.NET 2.0 Gridview/DetailsView/FormViews 해당 편집을 원하는 및/또는 삭제 및 뷰 상태를 사용 하지 않으면](http://scottonwriting.net/sowblog/posts/10054.aspx) 자세한 정보에 대 한 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="dceb5-235">5 단계: 지원 되지 않는 제품 때 보기/편집 모든 공급 업체는 선택 하지 않은 편집 허용 안 함</span><span class="sxs-lookup"><span data-stu-id="dceb5-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="dceb5-236">동안는 `ProductsBySupplier` GridView가 올바르게 작동 현재 부여 너무 많은 액세스 권한을 사용자에 게 특정 공급 업체에서 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="dceb5-237">이 비즈니스 규칙에 따라 이러한 사용자는 지원 되지 않는 제품을 업데이트할 수 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="dceb5-238">이 적용 하려면 म 수 숨길 (또는 해제) 지원 되지 않는 제품 공급 업체에서 사용자가 페이지를 방문 하는 경우 포함 된 GridView 행에서 편집 단추입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="dceb5-239">GridView s에 대 한 이벤트 처리기를 만들고 `RowDataBound` 이벤트입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="dceb5-240">이 이벤트 처리기에서 사용자가 Suppliers DropDownList s를 선택 하 여이 자습서에서 확인할 수 있는 특정 공급 업체와 연결 여부를 결정 해야 `SelectedValue` 속성-경우 것 이외의 형식-1로, 다음 사용자 s가 연결 된 특정 공급 업체입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="dceb5-241">이러한 사용자에 대 한 제품 지원 되지 않는 여부를 결정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="dceb5-242">실제에 대 한 참조를 얻을 수 있습니다 `ProductRow` 통해 GridView 행에 바인딩된 인스턴스는 `e.Row.DataItem` 속성에 설명 된 대로 [ *GridView의 바닥글의에서 요약 정보 표시* ](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) 자습서입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial.</span></span> <span data-ttu-id="dceb5-243">GridView s 이전 자습서에 설명 된 기술을 사용 하 여 CommandField에서에서 편집 단추에 대 한 프로그래밍 참조를 얻을 수 제품의 사용이 중지 되 면 [ *추가 클라이언트 쪽 확인 때 삭제* ](adding-client-side-confirmation-when-deleting-vb.md).</span><span class="sxs-lookup"><span data-stu-id="dceb5-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-vb.md).</span></span> <span data-ttu-id="dceb5-244">일단 숨기 거 나이 단추를 비활성화 한 다음 म 참조 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-244">Once we have a reference we can then hide or disable the button.</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample6.vb)]

<span data-ttu-id="dceb5-245">이 이벤트와 위치에 대 한 처리기를 편집할 수 없는이 페이지를 방문이 사용자로 특정 공급 업체에서 제품을 제공이 중단 된 경우 편집 5d; 단추로 숨겨져 이러한 제품에 대 한 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="dceb5-246">예를 들어 Chef 한 100의 수프는 새로 식품 케이준 사용해 공급 업체에 대 한 지원 되지 않는 제품입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="dceb5-247">이 제품에 대 한 편집 단추에서에서 숨겨져이 특정 공급 업체에 대 한 페이지를 방문 하는 경우 (그림 14 참조).</span><span class="sxs-lookup"><span data-stu-id="dceb5-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="dceb5-248">그러나 "보기/편집 모든 공급 업체"를 사용 하 여 방문 하는 경우 편집 단추는 (그림 15 참조).</span><span class="sxs-lookup"><span data-stu-id="dceb5-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>


<span data-ttu-id="dceb5-249">[![Chef 한 100의 수프에 대 한 편집 단추는 숨겨집니다 공급 업체 관련 사용자에 대 한](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span></span>

<span data-ttu-id="dceb5-250">**그림 14**: Chef 한 100의 수프에 대 한 편집 단추 숨겨져 공급 업체 관련 사용자에 대 한 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span></span>


<span data-ttu-id="dceb5-251">[![보기/편집 모든 공급 업체 사용자에 대해 Chef 한 100의 수프에 대 한 편집 단추가 표시 됩니다.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="dceb5-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span></span>

<span data-ttu-id="dceb5-252">**그림 15**: 사용자에 대 한 보기/편집 모든 공급 업체, 수프 표시 되는 Chef 한 100 s에 대 한 편집 단추 ([전체 크기 이미지를 보려면 클릭](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="dceb5-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span></span>


## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="dceb5-253">비즈니스 논리 계층에 대 한 액세스 권한을 확인 하는 중</span><span class="sxs-lookup"><span data-stu-id="dceb5-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="dceb5-254">페이지는 ASP.NET이이 자습서에서는 사용자가 볼 수 정보에 대해 모든 논리를 처리 하 고 업데이트할 수 그 어떤 제품입니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="dceb5-255">이상적으로이 논리는 비즈니스 논리 계층에 존재할 수도 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="dceb5-256">예를 들어는 `SuppliersBLL` s 클래스 `GetSuppliers()` (반환 하는 모든 공급 업체) 메서드는 현재 로그온된 한 사용자가 되도록 확인 포함 될 수 있습니다 *하지* 특정 공급 업체와 관련 된 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="dceb5-257">마찬가지로,는 `UpdateSupplierAddress` 메서드 하나 저희 회사에 대 한 작업 (및 따라서 모든 공급 업체 주소 정보를 업데이트할 수)는 현재 로그온된 한 사용자 확인 검사를 포함 될 수에 해당 데이터를 업데이트 하 고 공급 업체와 연결 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="dceb5-258">이 자습서의 s 사용자 권한은 DropDownList BLL 클래스에 액세스할 수 없는 페이지에 의해 결정 되기 때문에 이러한 BLL 레이어 검사 포함 없습니다 I.</span><span class="sxs-lookup"><span data-stu-id="dceb5-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="dceb5-259">멤버 자격 시스템 또는 (예: Windows 인증의 경우)에서 ASP.NET이 제공 아웃-기본 인증 스키마 중 하나를 사용 하는 경우 현재 로그온 한 사용자 s에 정보와 역할 정보에서에서 액세스할 수 있습니다 이러한 액세스를 받으므로 BLL 권한 확인 프레젠테이션 및 BLL 계층 모두에서 가능 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="dceb5-260">요약</span><span class="sxs-lookup"><span data-stu-id="dceb5-260">Summary</span></span>

<span data-ttu-id="dceb5-261">사용자 계정을 제공 하는 대부분의 사이트에 로그인 한 사용자 기반 데이터 수정 인터페이스를 사용자 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="dceb5-262">관리자 외 사용자만 업데이트 또는 직접 만든 레코드 삭제 제한 될 수 있습니다 하지만 관리자에 게 삭제 하 고 모든 레코드를 편집할 수. 있습니다</span><span class="sxs-lookup"><span data-stu-id="dceb5-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="dceb5-263">모든 시나리오 수, 데이터 웹 컨트롤, ObjectDataSource, 있으며 비즈니스 논리 계층 클래스를 추가 하 여 로그온된 한 사용자를 기반으로 특정 기능을 거부 확장 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="dceb5-264">이 자습서에서는 사용자가 특정 공급 업체와 연결 인지 또는 회사에 대 한 작업 하는 경우에 따라 고 볼 수 있는 편집 가능한 데이터를 제한 하는 방법에 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="dceb5-265">이 자습서에는 삽입, 업데이트 및 삭제 GridView, DetailsView, FormView 컨트롤을 사용 하 여 데이터를 검사 하는 완료 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="dceb5-266">다음 자습서를 시작 페이징 및 정렬 기능 추가 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="dceb5-267">만족도 매우 프로그래밍!</span><span class="sxs-lookup"><span data-stu-id="dceb5-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="dceb5-268">작성자 정보</span><span class="sxs-lookup"><span data-stu-id="dceb5-268">About the Author</span></span>

<span data-ttu-id="dceb5-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), 7 ASP/ASP.NET 서적과의 창립자의 작성자 [4GuysFromRolla.com](http://www.4guysfromrolla.com), 1998 이후 Microsoft 웹 기술과 함께 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="dceb5-270">Scott 독립 컨설턴트, 강사, 기술 및 작성기 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="dceb5-271">그의 최신 서적은 [ *Sam 업무량이 직접 ASP.NET 2.0 24 시간 동안에서*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="dceb5-272">에 연결할 수 그 [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) 에서 찾을 수 있는 그의 블로그를 통해 또는 [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)합니다.</span><span class="sxs-lookup"><span data-stu-id="dceb5-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="dceb5-273">이전</span><span class="sxs-lookup"><span data-stu-id="dceb5-273">Previous</span></span>](adding-client-side-confirmation-when-deleting-vb.md)
