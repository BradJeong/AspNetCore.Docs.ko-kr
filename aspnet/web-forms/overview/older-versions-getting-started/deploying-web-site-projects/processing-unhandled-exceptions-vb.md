---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb
title: 처리 되지 않은 예외로 (VB) | Microsoft Docs
author: rick-anderson
description: 프로덕션 환경에서 웹 응용 프로그램에서 런타임 오류가 발생할 때 고 것이 중요 개발자에 알리기 위해 la a에서 진단 수 있도록 오류를 기록 하려면...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/09/2009
ms.topic: article
ms.assetid: 051296f0-9519-4e78-835c-d868da13b0a0
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: cb42cf6c457cf20da7f65352bb7eed1230b59588
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30890179"
---
<a name="processing-unhandled-exceptions-vb"></a><span data-ttu-id="b68b9-103">처리 되지 않은 예외 (VB)를 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-103">Processing Unhandled Exceptions (VB)</span></span>
====================
<span data-ttu-id="b68b9-104">으로 [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b68b9-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b68b9-105">[예제 코드 살펴보기 및 다운로드](https://github.com/aspnet/Docs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb/samples)([다운로드 방법](/aspnet/core/tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="b68b9-105">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb/samples) ([how to download](/aspnet/core/tutorials/index#how-to-download-a-sample))</span></span>

> <span data-ttu-id="b68b9-106">프로덕션 환경에서 웹 응용 프로그램에서 런타임 오류가 발생할 때에 개발자에 게 시간에 나중에 진단할 수 수 있도록 오류를 기록 하려면 중요 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-106">When a runtime error occurs on a web application in production it is important to notify a developer and to log the error so that it may be diagnosed at a later point in time.</span></span> <span data-ttu-id="b68b9-107">이 자습서에서는 ASP.NET 런타임 오류를 처리 하 고 때마다 ASP.NET 런타임에 처리 되지 않은 예외가 거품을 실행 하는 사용자 지정 코드가 있는 한 가지 방법은 조사 하는 방법을 대 한 개요를 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-107">This tutorial provides an overview of how ASP.NET processes runtime errors and looks at one way to have custom code execute whenever an unhandled exception bubbles up to the ASP.NET runtime.</span></span>


## <a name="introduction"></a><span data-ttu-id="b68b9-108">소개</span><span class="sxs-lookup"><span data-stu-id="b68b9-108">Introduction</span></span>

<span data-ttu-id="b68b9-109">발생 시키는 ASP.NET 런타임에 버블링 ASP.NET 응용 프로그램에서 처리 되지 않은 예외가 발생 하는 경우는 `Error` 이벤트 적절 한 오류 페이지가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-109">When an unhandled exception occurs in an ASP.NET application, it bubbles up to the ASP.NET runtime, which raises the `Error` event and displays the appropriate error page.</span></span> <span data-ttu-id="b68b9-110">세 가지 유형의 오류 페이지에 없는:는 런타임 오류 노란색 화면의 사망 (YSOD); YSOD; 예외 세부 정보 및 사용자 지정 오류 페이지입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-110">There are three different types of error pages: the Runtime Error Yellow Screen of Death (YSOD); the Exception Details YSOD; and custom error pages.</span></span> <span data-ttu-id="b68b9-111">에 [이전 자습서](displaying-a-custom-error-page-vb.md) 로컬로 방문 하는 사용자에 대 한 예외 세부 정보 YSOD 및 원격 사용자에 대 한 사용자 지정 오류 페이지를 사용 하도록 응용 프로그램을 구성 했습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-111">In the [preceding tutorial](displaying-a-custom-error-page-vb.md) we configured the application to use a custom error page for remote users and the Exception Details YSOD for users visiting locally.</span></span>

<span data-ttu-id="b68b9-112">사이트의 모양과 느낌을 일치 하는 사용자에 게 친숙 한 사용자 지정 오류 페이지를 사용 하 여 기본 런타임 오류 YSOD에 선호 않으며 사용자 지정 오류 페이지를 표시 하는 것은 솔루션을 처리 하는 포괄적인 오류의 한 부분일 뿐입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-112">Using a human-friendly custom error page that matches the look and feel of the site is preferred to the default Runtime Error YSOD, but displaying a custom error page is only one part of a comprehensive error handling solution.</span></span> <span data-ttu-id="b68b9-113">프로덕션 환경에서 응용 프로그램에서 오류가 발생 하는 경우에 예외의 원인을 unearth 하 고 해결할 수 있도록 개발자가 오류 된다는 중요 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-113">When an error occurs in an application in production, it is important that the developers are notified of the error so that they can unearth the cause of the exception and address it.</span></span> <span data-ttu-id="b68b9-114">또한 오류의 세부 정보를 기록할 오류를 검사 하 고 나중에 시간에 진단 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-114">Furthermore, the error's details should be logged so that the error can be examined and diagnosed at a later point in time.</span></span>

<span data-ttu-id="b68b9-115">이 자습서에서는 기록 될 수 있도록 처리 되지 않은 예외의 세부 정보에 액세스 하는 방법과 알림을 개발자 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-115">This tutorial shows how to access the details of an unhandled exception so that they can be logged and a developer notified.</span></span> <span data-ttu-id="b68b9-116">이 중 하나를 수행 하는 두 개의 자습서 탐색 오류 로깅 하는 라이브러리, 구성, 약간만 자동 런타임 오류는 개발자에 게 알림 및 세부 정보를 기록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-116">The two tutorials following this one explore error logging libraries that, after a bit of configuration, will automatically notify developers of runtime errors and log their details.</span></span>

> [!NOTE]
> <span data-ttu-id="b68b9-117">이 자습서에서는 검사 정보 일부 고유 또는 사용자 지정 방식으로 처리 되지 않은 예외를 처리 하는 경우 가장 유용 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-117">The information examined in this tutorial is most useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="b68b9-118">만 해야 하는 경우 예외를 기록 하는 개발자에 게 알림, 오류 로깅 라이브러리를 사용 하는 이동 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-118">In cases where you only need to log the exception and notify a developer, using an error logging library is the way to go.</span></span> <span data-ttu-id="b68b9-119">다음 두 자습서에서는 이러한 두 개의 라이브러리의 개요를 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-119">The next two tutorials provide an overview of two such libraries.</span></span>


## <a name="executing-code-when-theerrorevent-is-raised"></a><span data-ttu-id="b68b9-120">때 코드 실행은`Error`이벤트 발생</span><span class="sxs-lookup"><span data-stu-id="b68b9-120">Executing Code When The`Error`Event Is Raised</span></span>

<span data-ttu-id="b68b9-121">이벤트 개체 발생 하는 흥미로운, 신호에 대 한 다른 개체에 대 한 응답에서 코드를 실행 하는 메커니즘을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-121">Events provide an object a mechanism for signaling that something interesting has occurred, and for another object to execute code in response.</span></span> <span data-ttu-id="b68b9-122">ASP.NET 개발자로 서 이벤트를 기준으로 생각 하는 데 익숙한 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-122">As an ASP.NET developer you are accustomed to thinking in terms of events.</span></span> <span data-ttu-id="b68b9-123">해당 단추에 대 한 이벤트 처리기를 만들고 방문자가 특정 단추를 클릭할 때 일부 코드를 실행 하려는 경우 `Click` 이벤트 및 코드 대시보드에 배치한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-123">If you want to run some code when the visitor clicks a particular Button, you create an event handler for that Button's `Click` event and put your code there.</span></span> <span data-ttu-id="b68b9-124">ASP.NET 런타임에서 발생 하는 [ `Error` 이벤트](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) 의 오류 세부 정보를 기록 하기 위한 코드는 이벤트 처리기에서 라인으로 설정 하에 따라 처리 되지 않은 예외가 발생할 때마다 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-124">Given that the ASP.NET runtime raises its [`Error` event](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) whenever an unhandled exception occurs, it follows that the code for logging the error's details would go in an event handler.</span></span> <span data-ttu-id="b68b9-125">하지만 방법에 대 한 이벤트 처리기를 만들 수 있습니다는 `Error` 이벤트?</span><span class="sxs-lookup"><span data-stu-id="b68b9-125">But how do you create an event handler for the `Error` event?</span></span>

<span data-ttu-id="b68b9-126">`Error` 이벤트는에서 대부분의 이벤트 중 하나는 [ `HttpApplication` 클래스](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) 요청 되는 동안 HTTP 파이프라인에서 특정 단계에서 발생 하는 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-126">The `Error` event is one of many events in the [`HttpApplication` class](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) that are raised at certain stages in the HTTP pipeline during the lifetime of a request.</span></span> <span data-ttu-id="b68b9-127">예를 들어는 `HttpApplication` 클래스의 [ `BeginRequest` 이벤트](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) 모든 요청;의 시작 부분에서 발생 해당 [ `AuthenticateRequest` 이벤트](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) 보안 모듈에서 요청자를 확인 하는 경우 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-127">For example, the `HttpApplication` class's [`BeginRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) is raised at the start of every request; its [`AuthenticateRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) is raised when a security module has identified the requestor.</span></span> <span data-ttu-id="b68b9-128">이러한 `HttpApplication` 이벤트 페이지 개발자는 요청 수명에 다양 한 포인트에서 사용자 지정 논리를 실행 하는 방법을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-128">These `HttpApplication` events give the page developer a means to execute custom logic at the various points in the lifetime of a request.</span></span>

<span data-ttu-id="b68b9-129">에 대 한 이벤트 처리기는 `HttpApplication` 이벤트 라는 특수 한 파일에 배치할 수 있습니다 `Global.asax`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-129">Event handlers for the `HttpApplication` events can be placed in a special file named `Global.asax`.</span></span> <span data-ttu-id="b68b9-130">웹 사이트에서이 파일을 만들려면 이름을 가진 전역 응용 프로그램 클래스 템플릿을 사용 하 여 웹 사이트의 루트에 새 항목을 추가 `Global.asax`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-130">To create this file in your website, add a new item to the root of your website using the Global Application Class template with the name `Global.asax`.</span></span>

[![](processing-unhandled-exceptions-vb/_static/image2.png)](processing-unhandled-exceptions-vb/_static/image1.png)

<span data-ttu-id="b68b9-131">**그림 1**: 추가 `Global.asax` 웹 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="b68b9-131">**Figure 1**: Add `Global.asax` To Your Web Application</span></span>  
 <span data-ttu-id="b68b9-132">([전체 크기 이미지를 보려면 클릭](processing-unhandled-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b68b9-132">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image3.png))</span></span>

<span data-ttu-id="b68b9-133">구조와 내용을 `Global.asax` Visual Studio에서 만든 파일은 응용 프로그램 프로젝트 WAP (웹) 또는 웹 사이트 프로젝트 (WSP) 사용 여부에 따라 약간씩 다 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-133">The contents and structure of the `Global.asax` file created by Visual Studio differ slightly based on whether you are using a Web Application Project (WAP) or Web Site Project (WSP).</span></span> <span data-ttu-id="b68b9-134">WAP와 `Global.asax` 두 개의 별도 파일로-구현 `Global.asax` 및 `Global.asax.vb`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-134">With a WAP, the `Global.asax` is implemented as two separate files - `Global.asax` and `Global.asax.vb`.</span></span> <span data-ttu-id="b68b9-135">`Global.asax` 파일에 다음 아무 것도 포함 되어 있지만 `@Application` 참조 하는 지시문의 `.vb` 파일; 관심의 처리기에 정의 된 이벤트는 `Global.asax.vb` 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-135">The `Global.asax` file contains nothing but an `@Application` directive that references the `.vb` file; the event handlers of interest are defined in the `Global.asax.vb` file.</span></span> <span data-ttu-id="b68b9-136">WSPs에 대 한 단일 파일만 만들어지면 `Global.asax`, 이벤트 처리기에서 정의 됩니다는 `<script runat="server">` 블록입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-136">For WSPs, only a single file is created, `Global.asax`, and the event handlers are defined in a `<script runat="server">` block.</span></span>

<span data-ttu-id="b68b9-137">`Global.asax` 라는 이벤트 처리기를 포함 하는 Visual Studio의 전역 응용 프로그램 클래스 템플릿에서 WAP에서 만든 파일 `Application_BeginRequest`, `Application_AuthenticateRequest`, 및 `Application_Error`에 대 한 이벤트 처리기를가 하는 `HttpApplication` 이벤트 `BeginRequest`, `AuthenticateRequest`, 및 `Error`각각.</span><span class="sxs-lookup"><span data-stu-id="b68b9-137">The `Global.asax` file created in a WAP by Visual Studio's Global Application Class template includes event handlers named `Application_BeginRequest`, `Application_AuthenticateRequest`, and `Application_Error`, which are event handlers for the `HttpApplication` events `BeginRequest`, `AuthenticateRequest`, and `Error`, respectively.</span></span> <span data-ttu-id="b68b9-138">명명 된 이벤트 처리기도 있습니다. `Application_Start`, `Session_Start`, `Application_End`, 및 `Session_End`이며 웹 응용 프로그램이 시작 되 면 새 세션이 시작할 때 응용 프로그램이 종료 될 때 발생 하는 이벤트 처리기가 세션이 종료 되 고 각각.</span><span class="sxs-lookup"><span data-stu-id="b68b9-138">There are also event handlers named `Application_Start`, `Session_Start`, `Application_End`, and `Session_End`, which are event handlers that fire when the web application starts, when a new session starts, when the application ends, and when a session ends, respectively.</span></span> <span data-ttu-id="b68b9-139">`Global.asax` WSP에서 Visual Studio에서 만든 파일을 포함 된 `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, 및 `Session_End` 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-139">The `Global.asax` file created in a WSP by Visual Studio contains just the `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, and `Session_End` event handlers.</span></span>

> [!NOTE]
> <span data-ttu-id="b68b9-140">복사 해야 하는 ASP.NET 응용 프로그램을 배포 하는 경우는 `Global.asax` 프로덕션 환경에는 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-140">When deploying the ASP.NET application you need to copy the `Global.asax` file to the production environment.</span></span> <span data-ttu-id="b68b9-141">`Global.asax.vb` 는 WAP에서 생성 된 파일을 프로젝트의 어셈블리에이 코드는 컴파일되므로 프로덕션에 복사할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-141">The `Global.asax.vb` file, which is created in the WAP, does not need to be copied to production because this code is compiled into the project's assembly.</span></span>


<span data-ttu-id="b68b9-142">Visual Studio의 전역 응용 프로그램 클래스 템플릿으로 만든 이벤트 처리기 하지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-142">The event handlers created by Visual Studio's Global Application Class template are not exhaustive.</span></span> <span data-ttu-id="b68b9-143">에 대 한 이벤트 처리기를 추가할 수 있습니다 `HttpApplication` 이벤트 처리기의 이름을 지정 하 여 이벤트 `Application_EventName`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-143">You can add an event handler for any `HttpApplication` event by naming the event handler `Application_EventName`.</span></span> <span data-ttu-id="b68b9-144">예를 들어 다음 코드를 추가할 수 있습니다는 `Global.asax` 에 대 한 이벤트 처리기를 만들려는 파일의 [ `AuthorizeRequest` 이벤트](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span><span class="sxs-lookup"><span data-stu-id="b68b9-144">For example, you could add the following code to the `Global.asax` file to create an event handler for the [`AuthorizeRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample1.vb)]

<span data-ttu-id="b68b9-145">마찬가지로, 전역 응용 프로그램 클래스 템플릿으로 만든 필요 하지 않은 모든 이벤트 처리기를 제거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-145">Likewise, you can remove any event handlers created by the Global Application Class template that are not needed.</span></span> <span data-ttu-id="b68b9-146">이 자습서에서는 필요한에 대 한 이벤트 처리기는 `Error` 이벤트를 자유롭게 다른 이벤트 처리기를 제거 하 고 `Global.asax` 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-146">For this tutorial we only require an event handler for the `Error` event; feel free to remove the other event handlers from the `Global.asax` file.</span></span>

> [!NOTE]
> <span data-ttu-id="b68b9-147">*HTTP 모듈* 제공에 대 한 이벤트 처리기를 정의 하는 다른 방법은 `HttpApplication` 이벤트입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-147">*HTTP Modules* offer another way to define event handlers for `HttpApplication` events.</span></span> <span data-ttu-id="b68b9-148">HTTP 모듈은 별도 클래스 라이브러리에 직접 웹 응용 프로그램 프로젝트 내에 배치 하거나 분리할 수 있는 클래스 파일을으로 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-148">HTTP Modules are created as a class file that can be placed directly within the web application project or separated out into a separate class library.</span></span> <span data-ttu-id="b68b9-149">HTTP 모듈을 만들기 위한 보다 유연 하 고 다시 사용할 수 있는 모델을 제공 클래스 라이브러리로 구분 될 수 있습니다, 때문에 `HttpApplication` 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-149">Because they can be separated out into a class library, HTTP Modules offer a more flexible and reusable model for creating `HttpApplication` event handlers.</span></span> <span data-ttu-id="b68b9-150">반면는 `Global.asax` 파일은 특정 있는 웹 응용 프로그램에 HTTP 모듈 이때 웹 사이트에 HTTP 모듈을 추가 하기만 하면 됩니다 어셈블리를 삭제 하는 중 어셈블리로 컴파일할 수는 `Bin` 폴더 및 등록 된 모듈에 `Web.config`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-150">Whereas the `Global.asax` file is specific to the web application where it resides, HTTP Modules can be compiled into assemblies, at which point adding the HTTP Module to a website is as simple as dropping the assembly in the `Bin` folder and registering the Module in `Web.config`.</span></span> <span data-ttu-id="b68b9-151">이 자습서를 작성 하 고 HTTP 모듈을 사용 하 여 찾지 않습니다 되지만 다음과 같은 두 개의 자습서에 사용 되는 두 개의 오류 로깅 라이브러리 HTTP 모듈로 구현 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-151">This tutorial does not look at creating and using HTTP Modules, but the two error logging libraries used in the following two tutorials are implemented as HTTP Modules.</span></span> <span data-ttu-id="b68b9-152">자세한 배경을 알고 싶으면 HTTP 모듈의 이점에 대 한 참조 [를 사용 하 여 HTTP 모듈 및 처리기 플러그형 ASP.NET 구성 요소 만들기에](https://msdn.microsoft.com/library/aa479332.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-152">For more background on the benefits of HTTP Modules refer to [Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components](https://msdn.microsoft.com/library/aa479332.aspx).</span></span>


## <a name="retrieving-information-about-the-unhandled-exception"></a><span data-ttu-id="b68b9-153">처리 되지 않은 예외에 대 한 정보 검색</span><span class="sxs-lookup"><span data-stu-id="b68b9-153">Retrieving Information About the Unhandled Exception</span></span>

<span data-ttu-id="b68b9-154">Global.asax 파일을 했으므로 시점에서 `Application_Error` 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-154">At this point we have a Global.asax file with an `Application_Error` event handler.</span></span> <span data-ttu-id="b68b9-155">이 이벤트 처리기를 실행 하는 경우 오류 개발자에 게 알림와 세부 정보를 로그 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-155">When this event handler executes we need to notify a developer of the error and log its details.</span></span> <span data-ttu-id="b68b9-156">이러한 작업을 수행 하려면 먼저 발생 한 예외의 세부 정보를 확인 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-156">To accomplish these tasks we first need to determine the details of the exception that was raised.</span></span> <span data-ttu-id="b68b9-157">서버 개체를 사용 하 여 [ `GetLastError` 메서드](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) 시킨 처리 되지 않은 예외의 세부 정보를 검색 하는 `Error` 이벤트를 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-157">Use the Server object's [`GetLastError` method](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) to retrieve details of the unhandled exception that caused the `Error` event to fire.</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="b68b9-158">`GetLastError` 메서드 반환 형식의 개체 `Exception`가.NET Framework의 모든 예외에 대 한 기본 유형입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-158">The `GetLastError` method returns an object of type `Exception`, which is the base type for all exceptions in the .NET Framework.</span></span> <span data-ttu-id="b68b9-159">그러나 위의 코드에서 I am 캐스팅 반환 되는 예외 개체 `GetLastError` 에 `HttpException` 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-159">However, in the code above I am casting the Exception object returned by `GetLastError` into an `HttpException` object.</span></span> <span data-ttu-id="b68b9-160">경우는 `Error` 내에서 throw 된 예외 래핑된 다음 ASP.NET 리소스를 처리 하는 동안 예외가 throw 되었기 때문에 이벤트가 발생 되는 `HttpException`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-160">If the `Error` event is being fired because an exception was thrown during the processing of an ASP.NET resource then the exception that was thrown is wrapped within an `HttpException`.</span></span> <span data-ttu-id="b68b9-161">시킨 오류 이벤트를 사용 하 여 실제 예외를 가져오려는 `InnerException` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-161">To get the actual exception that precipitated the Error event use the `InnerException` property.</span></span> <span data-ttu-id="b68b9-162">경우는 `Error` HTTP 기반 예외로 인해 존재 하지 않는 페이지에 대 한 요청과 같이 이벤트가 발생 한 `HttpException` throw 되며, 내부 예외가 없는 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-162">If the `Error` event was raised because of an HTTP-based exception, such as a request for a non-existent page, an `HttpException` is thrown, but it does not have an inner exception.</span></span>

<span data-ttu-id="b68b9-163">다음 코드에서는 `GetLastErrormessage` 를 발생 시킨 예외에 대 한 정보를 검색 하는 `Error` 이벤트를 저장 된 `HttpException` 이라는 변수에 `lastErrorWrapper`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-163">The following code uses the `GetLastErrormessage` to retrieve information about the exception that triggered the `Error` event, storing the `HttpException` in a variable named `lastErrorWrapper`.</span></span> <span data-ttu-id="b68b9-164">다음 저장 유형, 메시지 및 스택 추적 원래 예외의 세 개의 문자열 변수를 확인 하는 경우에 `lastErrorWrapper` 는 실제 예외를 발생 시킨는 `Error` 이벤트 (의 경우 HTTP 기반 예외 포함) 또는 단순히 인지는 요청을 처리 하는 동안 throw 된 예외에 대 한 래퍼.</span><span class="sxs-lookup"><span data-stu-id="b68b9-164">It then stores the type, message, and stack trace of the originating exception in three string variables, checking to see if the `lastErrorWrapper` is the actual exception that triggered the `Error` event (in the case of HTTP-based exceptions) or if it's merely a wrapper for an exception that was thrown while processing the request.</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="b68b9-165">이 시점에서 데이터베이스 테이블에는 예외 세부 정보를 기록 합니다는 코드를 작성 하는 데 필요한 모든 정보를 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-165">At this point you have all the information you need to write code that will log the exception's details to a database table.</span></span> <span data-ttu-id="b68b9-166">각 관심-유형, 메시지, 스택 추적 등에-다른 유용한 가지 요청된 된 페이지의 URL 및 현재 로그온된 한 사용자의 이름과 같은 정보를 함께 오류 세부 정보에 대 한 열이 있는 데이터베이스 테이블을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-166">You could create a database table with columns for each of the error details of interest - the type, the message, the stack trace, and so on - along with other useful pieces of information, such as the URL of the requested page and the name of the currently logged on user.</span></span> <span data-ttu-id="b68b9-167">에 `Application_Error` 이벤트 처리기 다음 데이터베이스에 연결 하는 테이블에 레코드를 삽입 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-167">In the `Application_Error` event handler you would then connect to the database and insert a record into the table.</span></span> <span data-ttu-id="b68b9-168">마찬가지로, 개발자는 전자 메일을 통해 오류를 경고 하는 코드를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-168">Likewise, you could add code to alert a developer of the error via email.</span></span>

<span data-ttu-id="b68b9-169">다음 두 자습서에서 검사 하는 오류 로깅 라이브러리 이므로이 오류 로그 및 알림 사용자가 직접 구성할 필요가 없습니다 기본적으로 이러한 기능을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-169">The error logging libraries examined in the next two tutorials provide such functionality out of the box, so there's no need to build this error logging and notification yourself.</span></span> <span data-ttu-id="b68b9-170">그러나를 설명 하기 위해는 `Error` 이벤트가 발생 하는 `Application_Error` 이벤트 처리기를 사용 하 여 오류 세부 정보를 기록 하 고 개발자에 게 알림, 오류가 발생 하면 개발자에 게 알려 주는 코드를 추가 하겠습니다를 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-170">However, to illustrate that the `Error` event is being raised and that the `Application_Error` event handler can be used to log error details and notify a developer, let's add code that notifies a developer when an error occurs.</span></span>

## <a name="notifying-a-developer-when-an-unhandled-exception-occurs"></a><span data-ttu-id="b68b9-171">처리 되지 않은 예외가 발생할 때 개발자에 게 알리는</span><span class="sxs-lookup"><span data-stu-id="b68b9-171">Notifying a Developer When an Unhandled Exception Occurs</span></span>

<span data-ttu-id="b68b9-172">프로덕션 환경에서 처리 되지 않은 예외가 발생 하는 경우에 개발 팀의 경고는 오류를 평가 하 고 수행 해야 하는 작업을 확인할 수 있도록 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-172">When an unhandled exception occurs in the production environment it is important to alert the development team so that they can assess the error and determine what actions need to be taken.</span></span> <span data-ttu-id="b68b9-173">예를 들어 없을 경우 double로 해야 합니다는 데이터베이스에 대 한 연결에 오류가 확인 연결 문자열 하 고, 웹 호스팅 회사도 지원 티켓을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-173">For example, if there is an error in connecting to the database then you'll need to double check your connection string and, perhaps, open a support ticket with your web hosting company.</span></span> <span data-ttu-id="b68b9-174">예외는 프로그래밍 오류 때문에 발생 한 경우 추가 코드 또는 유효성 검사 논리를 나중에 이러한 오류를 방지 하기 위해 추가 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-174">If the exception occurred because of a programming error, additional code or validation logic may need to be added to prevent such errors in the future.</span></span>

<span data-ttu-id="b68b9-175">사용 되는.NET Framework 클래스는 [ `System.Net.Mail` 네임 스페이스](https://msdn.microsoft.com/library/system.net.mail.aspx) 쉽게 전자 메일을 보낼 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-175">The .NET Framework classes in the [`System.Net.Mail` namespace](https://msdn.microsoft.com/library/system.net.mail.aspx) make it easy to send an email.</span></span> <span data-ttu-id="b68b9-176">[ `MailMessage` 클래스](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) 전자 메일 메시지를 나타내며 같은 속성을 보유 `To`, `From`, `Subject`, `Body`, 및 `Attachments`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-176">The [`MailMessage` class](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) represents an email message and has properties like `To`, `From`, `Subject`, `Body`, and `Attachments`.</span></span> <span data-ttu-id="b68b9-177">`SmtpClass` 보내는 데 사용 되는 `MailMessage` 개체는 지정 된 SMTP 서버를 사용 하 여, SMTP 서버 설정에서 프로그래밍 방식으로 또는 선언적으로 지정할 수 있습니다는 [ `<system.net>` 요소](https://msdn.microsoft.com/library/6484zdc1.aspx) 에 `Web.config file`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-177">The `SmtpClass` is used to send a `MailMessage` object using a specified SMTP server; the SMTP server settings can be specified programmatically or declaratively in the [`<system.net>` element](https://msdn.microsoft.com/library/6484zdc1.aspx) in the `Web.config file`.</span></span> <span data-ttu-id="b68b9-178">전자 메일을 보내는 방법에 대 한 자세한 내용은 ASP.NET 응용 프로그램에서 메시지 확인해 내 문서 [ASP.NET에서 전자 메일 보내기](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx), 및 [System.Net.Mail FAQ](http://systemnetmail.com/)합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-178">For more information on sending email messages in an ASP.NET application check out my article, [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx), and the [System.Net.Mail FAQ](http://systemnetmail.com/).</span></span>

> [!NOTE]
> <span data-ttu-id="b68b9-179">`<system.net>` 요소에서 사용 하는 SMTP 서버 설정이 포함 되어는 `SmtpClient` 전자 메일을 보낼 때 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-179">The `<system.net>` element contains the SMTP server settings used by the `SmtpClient` class when sending an email.</span></span> <span data-ttu-id="b68b9-180">웹 호스팅 가능성이 회사 전자 메일을 보내는 응용 프로그램에서 사용할 수 있는 SMTP 서버를 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-180">Your web hosting company likely has an SMTP server that you can use to send email from your application.</span></span> <span data-ttu-id="b68b9-181">웹 응용 프로그램에서 사용 해야 하는 SMTP 서버 설정에 대 한 정보는 웹 호스트의 지원 섹션을 참조 하십시오.</span><span class="sxs-lookup"><span data-stu-id="b68b9-181">Consult your web host's support section for information on the SMTP server settings you should use in your web application.</span></span>


<span data-ttu-id="b68b9-182">다음 코드를 추가 하는 `Application_Error` 개발자는 전자 메일을 보내는 오류가 발생할 때 이벤트 처리기.</span><span class="sxs-lookup"><span data-stu-id="b68b9-182">Add the following code to the `Application_Error` event handler to send a developer an email when an error occurs:</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample4.vb)]

<span data-ttu-id="b68b9-183">위의 코드는 매우 긴,에서는 대량의 개발자에 게 보내는 전자 메일에 표시 되는 HTML을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-183">While the above code is quite lengthy, the bulk of it creates the HTML that appears in the email sent to the developer.</span></span> <span data-ttu-id="b68b9-184">참조 하 여 시작 하는 코드는 `HttpException` 에서 반환 되는 `GetLastError` 메서드 (`lastErrorWrapper`).</span><span class="sxs-lookup"><span data-stu-id="b68b9-184">The code starts by referencing the `HttpException` returned by the `GetLastError` method (`lastErrorWrapper`).</span></span> <span data-ttu-id="b68b9-185">요청에 의해 발생 한 실제 예외를 통해 검색은 `lastErrorWrapper.InnerException` 변수에 할당 하 고 `lastError`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-185">The actual exception that was raised by the request is retrieved via `lastErrorWrapper.InnerException` and is assigned to the variable `lastError`.</span></span> <span data-ttu-id="b68b9-186">유형, 메시지 및 스택 추적 정보에서 검색 됩니다 `lastError` 이며 세 개의 문자열 변수에 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-186">The type, message, and stack trace information is retrieved from `lastError` and stored in three string variables.</span></span>

<span data-ttu-id="b68b9-187">다음으로 `MailMessage` 라는 개체 `mm` 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-187">Next, a `MailMessage` object named `mm` is created.</span></span> <span data-ttu-id="b68b9-188">전자 메일 본문에는 HTML 형식의 이며 요청된 된 페이지의 URL는 현재 로그온된 한 사용자 이름과 (유형, 메시지 및 스택 추적) 예외에 대 한 정보를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-188">The email body is HTML formatted and displays the URL of the requested page, the name of the currently logged on user, and information about the exception (the type, message, and stack trace).</span></span> <span data-ttu-id="b68b9-189">에 대 한 유용한 기능 중 하나는 `HttpException` 클래스는를 호출 하 여는 예외 세부 정보 노란색 화면의 사망 (YSOD)를 만드는 데 사용 되는 HTML을 생성할 수 있습니다는 [GetHtmlErrorMessage 메서드](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx)합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-189">One of the cool things about the `HttpException` class is that you can generate the HTML used to create the Exception Details Yellow Screen of Death (YSOD) by calling the [GetHtmlErrorMessage method](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx).</span></span> <span data-ttu-id="b68b9-190">이 메서드는 예외 세부 정보 YSOD 태그를 검색 하 고 첨부 파일로 메일에 추가 하려면 여기 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-190">This method is used here to retrieve the Exception Details YSOD markup and add it to the email as an attachment.</span></span> <span data-ttu-id="b68b9-191">주의 사항: 발생 하는 예외는 `Error` 이벤트 (예: 존재 하지 않는 페이지에 대 한 요청) HTTP 기반 예외가 했습니다 하면 `GetHtmlErrorMessage` 메서드는 반환 `null`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-191">One word of caution: if the exception that triggered the `Error` event was an HTTP-based exception (such as a request for a non-existent page) then the `GetHtmlErrorMessage` method will return `null`.</span></span>

<span data-ttu-id="b68b9-192">마지막 단계는 보낼는 `MailMessage`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-192">The final step is to send the `MailMessage`.</span></span> <span data-ttu-id="b68b9-193">새 이렇게 `SmtpClient` 메서드와 호출 해당 `Send` 메서드.</span><span class="sxs-lookup"><span data-stu-id="b68b9-193">This is done by creating a new `SmtpClient` method and calling its `Send` method.</span></span>

> [!NOTE]
> <span data-ttu-id="b68b9-194">웹 응용 프로그램에서이 코드를 사용 하기 전에 값을 변경 해야는 `ToAddress` 및 `FromAddress` 상수 support@example.com 어떤 전자 메일에 오류 알림 전자 메일 주소를 보낼 및에서 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-194">Before using this code in your web application you'll want to change the values in the `ToAddress` and `FromAddress` constants from support@example.com to whatever email address the error notification email should be sent to and originate from.</span></span> <span data-ttu-id="b68b9-195">에 SMTP 서버 설정을 지정 해야는 `<system.net>` 섹션 `Web.config`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-195">You'll also need to specify SMTP server settings in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="b68b9-196">사용할 SMTP 서버 설정을 확인 하 여 웹 호스트 공급자를 참조 하십시오.</span><span class="sxs-lookup"><span data-stu-id="b68b9-196">Consult your web host provider to determine the SMTP server settings to use.</span></span>


<span data-ttu-id="b68b9-197">이 코드 위치에서 오류로 인해 개발자가 전송 오류 요약 하 고는 YSOD를 포함 하는 전자 메일 메시지.</span><span class="sxs-lookup"><span data-stu-id="b68b9-197">With this code in place anytime there's an error the developer is sent an email message that summarizes the error and includes the YSOD.</span></span> <span data-ttu-id="b68b9-198">이전 자습서에서 시연을 런타임 오류 Genre.aspx를 방문 하 고 잘못 된를 전달 하 여 `ID` like는 쿼리 문자열을 통해 값 `Genre.aspx?ID=foo`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-198">In the preceding tutorial we demonstrated a runtime error by visiting Genre.aspx and passing in an invalid `ID` value through the querystring, like `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="b68b9-199">사용 하 여 페이지 방문의 `Global.asax` -이전 자습서에서 개발 환경에서 계속 해 서에서는 프로덕션 환경에서 예외 세부 정보 노란색 화면의 사망, 볼 처럼으로 동일한 사용자 환경을 생성 하는 곳에 파일 사용자 지정 오류 페이지를 참조 하십시오.</span><span class="sxs-lookup"><span data-stu-id="b68b9-199">Visiting the page with the `Global.asax` file in place produces the same user experience as in the preceding tutorial - in the development environment you'll continue to see the Exception Details Yellow Screen of Death, while in the production environment you'll see the custom error page.</span></span> <span data-ttu-id="b68b9-200">개발자는이 기존 동작 외에도 전자 메일을 전송 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-200">In addition to this existing behavior, the developer is sent an email.</span></span>

<span data-ttu-id="b68b9-201">**그림 2** 을 방문할 때 받은 전자 메일을 보여 줍니다 `Genre.aspx?ID=foo`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-201">**Figure 2** shows the email received when visiting `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="b68b9-202">전자 메일 본문에서 예외 정보를 요약 하는 동안는 `YSOD.htm` 첨부 파일에는 예외 세부 정보 YSOD에 표시 되는 콘텐츠가 표시 됩니다 (참조 **그림 3**).</span><span class="sxs-lookup"><span data-stu-id="b68b9-202">The email body summarizes the exception information, while the `YSOD.htm` attachment displays the content that is shown in the Exception Details YSOD (see **Figure 3**).</span></span>

[![](processing-unhandled-exceptions-vb/_static/image5.png)](processing-unhandled-exceptions-vb/_static/image4.png)

<span data-ttu-id="b68b9-203">**그림 2**: 개발자 처리 되지 않은 예외가 있을 때마다 전자 메일 알림이 전송 됩니다</span><span class="sxs-lookup"><span data-stu-id="b68b9-203">**Figure 2**: The Developer Is Sent An Email Notification Whenever There's An Unhandled Exception</span></span>  
 <span data-ttu-id="b68b9-204">([전체 크기 이미지를 보려면 클릭](processing-unhandled-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b68b9-204">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image6.png))</span></span>

[![](processing-unhandled-exceptions-vb/_static/image8.png)](processing-unhandled-exceptions-vb/_static/image7.png)

<span data-ttu-id="b68b9-205">**그림 3**: 전자 메일 첨부 파일로 YSOD 예외 정보 포함</span><span class="sxs-lookup"><span data-stu-id="b68b9-205">**Figure 3**: The Email Notification Includes the Exception Details YSOD As An Attachment</span></span>  
 <span data-ttu-id="b68b9-206">([전체 크기 이미지를 보려면 클릭](processing-unhandled-exceptions-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b68b9-206">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image9.png))</span></span>

## <a name="what-about-using-the-custom-error-page"></a><span data-ttu-id="b68b9-207">사용자 지정 오류 페이지를 사용 하 여 작업은 어떤가요?</span><span class="sxs-lookup"><span data-stu-id="b68b9-207">What About Using the Custom Error Page?</span></span>

<span data-ttu-id="b68b9-208">이 자습서에 사용 하는 방법을 보여 주었습니다 `Global.asax` 및 `Application_Error` 이벤트 처리기에 코드를 실행 하 여 처리 되지 않은 예외가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-208">This tutorial showed how to use `Global.asax` and the `Application_Error` event handler to execute code when an unhandled exception occurs.</span></span> <span data-ttu-id="b68b9-209">구체적으로, 개발자는 오류를 알리기 위해이 이벤트 처리기를 사용 했습니다. 도 데이터베이스에서 오류 세부 정보를 기록 하에 모두 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-209">Specifically, we used this event handler to notify a developer of an error; we could extend it to also log the error details in a database.</span></span> <span data-ttu-id="b68b9-210">존재는 `Application_Error` 이벤트 처리기는 최종 사용자 환경에 영향을 주지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-210">The presence of the `Application_Error` event handler does not affect the end user's experience.</span></span> <span data-ttu-id="b68b9-211">오류 세부 정보 YSOD, 런타임 오류 YSOD 또는 사용자 지정 오류 페이지 수는 구성 된 오류 페이지도 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-211">They still see the configured error page, be it the Error Details YSOD, the Runtime Error YSOD, or the custom error page.</span></span>

<span data-ttu-id="b68b9-212">관심을 가질 수 있도록 자연스럽 여부는 `Global.asax` 파일 및 `Application_Error` 이벤트는 사용자 지정 오류 페이지를 사용 하는 경우에 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-212">It's natural to wonder whether the `Global.asax` file and `Application_Error` event is necessary when using a custom error page.</span></span> <span data-ttu-id="b68b9-213">오류가 발생할 사용자가 사용자 지정 오류 페이지를 표시 하는 경우 지금 이유 없습니다 우리는 코드를 삽입 개발자에 게 사용자 지정 오류 페이지의 코드 숨김 클래스에 오류 세부 정보를 로그인 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-213">When an error occurs the user is shown the custom error page so why can't we put the code to notify the developer and log the error details into the code-behind class of the custom error page?</span></span> <span data-ttu-id="b68b9-214">발생 시킨 예외의 세부 정보에 액세스할 수 없는 사용자 지정 오류 페이지의 코드 숨김 클래스를 확실히 코드를 추가할 수는 있지만 `Error` 이전 자습서에서 살펴본 기법을 사용할 때에 이벤트입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-214">While you can certainly add code to the custom error page's code-behind class you do not have access to the details of the exception that triggered the `Error` event when using the technique we explored in the preceding tutorial.</span></span> <span data-ttu-id="b68b9-215">호출 된 `GetLastError` 사용자 지정 오류 페이지에 있는 메서드의 반환 `Nothing`합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-215">Calling the `GetLastError` method from the custom error page returns `Nothing`.</span></span>

<span data-ttu-id="b68b9-216">이 동작에 대 한 이유는 리디렉션을 통해 사용자 지정 오류 페이지에 도달 하면 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-216">The reason for this behavior is because the custom error page is reached via a redirect.</span></span> <span data-ttu-id="b68b9-217">처리 되지 않은 예외에 도달 하면 ASP.NET 런타임이 ASP.NET 엔진 발생 해당 `Error` 이벤트 (를 실행 하는 `Application_Error` 이벤트 처리기) 차례로 *리디렉션합니다* 는 를실행하여사용자지정오류페이지를사용자`Response.Redirect(customErrorPageUrl)`.</span><span class="sxs-lookup"><span data-stu-id="b68b9-217">When an unhandled exception reaches the ASP.NET runtime the ASP.NET engine raises its `Error` event (which executes the `Application_Error` event handler) and then *redirects* the user to the custom error page by issuing a `Response.Redirect(customErrorPageUrl)`.</span></span> <span data-ttu-id="b68b9-218">`Response.Redirect` 메서드는 사용자 지정 오류 페이지 새 URL을 요청 하도록 브라우저에 지시 하는 HTTP 302 상태 코드로 클라이언트에 대 한 응답을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-218">The `Response.Redirect` method sends a response to the client with an HTTP 302 status code, instructing the browser to request a new URL, namely the custom error page.</span></span> <span data-ttu-id="b68b9-219">브라우저에서 다음 자동으로 요청이 새 페이지.</span><span class="sxs-lookup"><span data-stu-id="b68b9-219">The browser then automatically requests this new page.</span></span> <span data-ttu-id="b68b9-220">알 수 있습니다는 사용자 지정 오류 페이지는 페이지에서 별도로 요청 되는 사용자 지정 오류 페이지 URL을 브라우저의 주소 표시줄 변경 되기 때문에 오류가 발생 (참조 **그림 4**).</span><span class="sxs-lookup"><span data-stu-id="b68b9-220">You can tell that the custom error page was requested separately from the page where the error originated because the browser's Address bar changes to the custom error page URL (see **Figure 4**).</span></span>

[![](processing-unhandled-exceptions-vb/_static/image11.png)](processing-unhandled-exceptions-vb/_static/image10.png)

<span data-ttu-id="b68b9-221">**그림 4**: 때 오류가 발생 브라우저 사용자 지정 오류 페이지 URL로 리디렉션됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-221">**Figure 4**: When an Error Occurs the Browser Gets Redirected to the Custom Error Page URL</span></span>  
 <span data-ttu-id="b68b9-222">([전체 크기 이미지를 보려면 클릭](processing-unhandled-exceptions-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b68b9-222">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image12.png))</span></span>

<span data-ttu-id="b68b9-223">한 순수 효과 처리 되지 않은 예외가 발생 하는 요청 HTTP 302 리디렉션을 때 끝나는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-223">The net effect is that the request where the unhandled exception occurred ends when the server responds with the HTTP 302 redirect.</span></span> <span data-ttu-id="b68b9-224">사용자 지정 오류 페이지에 대 한 후속 요청은 완전히 새로운 요청; ASP.NET이 시점 엔진 오류 정보는 삭제 하 고는 또한 사용자 지정 오류 페이지에 대 한 새 요청 이전 요청에서 처리 되지 않은 예외를 연결할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-224">The subsequent request to the custom error page is a brand new request; by this point the ASP.NET engine has discarded the error information and, moreover, has no way to associate the unhandled exception in the previous request with the new request for the custom error page.</span></span> <span data-ttu-id="b68b9-225">이 인해 `GetLastError` 반환 `null` 사용자 지정 오류 페이지에서 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-225">This is why `GetLastError` returns `null` when called from the custom error page.</span></span>

<span data-ttu-id="b68b9-226">그러나, 사용자 지정 오류 페이지에 오류가 발생 한 동일한 요청 하는 동안 실행 수는 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-226">However, it is possible to have the custom error page executed during the same request that caused the error.</span></span> <span data-ttu-id="b68b9-227">[ `Server.Transfer(url)` ](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) 메서드 실행을 지정된 된 URL로 이동 하 고 동일한 요청 내에서 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-227">The [`Server.Transfer(url)`](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) method transfers execution to the specified URL and processes it within the same request.</span></span> <span data-ttu-id="b68b9-228">코드를 이동할 수는 `Application_Error` 이벤트 처리기에서 대체 되는 사용자 지정 오류 페이지의 코드 숨김 클래스를 `Global.asax` 를 다음 코드로:</span><span class="sxs-lookup"><span data-stu-id="b68b9-228">You could move the code in the `Application_Error` event handler to the custom error page's code-behind class, replacing it in `Global.asax` with the following code:</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="b68b9-229">처리 되지 않은 예외가 발생할 때 이제는 `Application_Error` 이벤트 처리기는 HTTP 상태 코드에 따라 적절 한 사용자 지정 오류 페이지에 제어를 전달 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-229">Now when an unhandled exception occurs the `Application_Error` event handler transfers control to the appropriate custom error page based on the HTTP status code.</span></span> <span data-ttu-id="b68b9-230">사용자 지정 오류 페이지에 통해 처리 되지 않은 예외 정보에 대 한 액세스 제어 전송 되어 `Server.GetLastError` 와 오류의 개발자에 게 알림 하 고 해당 정보를 기록할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-230">Because control was transferred, the custom error page has access to the unhandled exception information via `Server.GetLastError` and can notify a developer of the error and log its details.</span></span> <span data-ttu-id="b68b9-231">`Server.Transfer` 호출이 사용자 지정 오류 페이지에 사용자를 리디렉션할 ASP.NET 엔진을 중지 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-231">The `Server.Transfer` call stops the ASP.NET engine from redirecting the user to the custom error page.</span></span> <span data-ttu-id="b68b9-232">대신, 사용자 지정 오류 페이지의 콘텐츠는 오류를 생성 하는 페이지에 대 한 응답으로 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-232">Instead, the custom error page's content is returned as the response to the page that generated the error.</span></span>

## <a name="summary"></a><span data-ttu-id="b68b9-233">요약</span><span class="sxs-lookup"><span data-stu-id="b68b9-233">Summary</span></span>

<span data-ttu-id="b68b9-234">ASP.NET 런타임에서 발생 하는 ASP.NET 웹 응용 프로그램에서 처리 되지 않은 예외가 발생 하는 경우는 `Error` 이벤트 구성 된 오류 페이지가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-234">When an unhandled exception occurs in an ASP.NET web application the ASP.NET runtime raises the `Error` event and displays the configured error page.</span></span> <span data-ttu-id="b68b9-235">오류를 개발자에 게 수 공지 세부 정보를 기록 하거나 오류 이벤트에 대 한 이벤트 처리기를 만들어이 다른 방식으로 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-235">We can notify the developer of the error, log its details, or process it in some other fashion, by creating an event handler for the Error event.</span></span> <span data-ttu-id="b68b9-236">두 가지 방법으로 이벤트 처리기를 만들 수 `HttpApplication` 와 같은 이벤트 `Error`:에서 `Global.asax` 파일 또는 HTTP 모듈에서 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-236">There are two ways to create an event handler for `HttpApplication` events like `Error`: in the `Global.asax` file or from an HTTP Module.</span></span> <span data-ttu-id="b68b9-237">이 자습서를 만드는 방법을 살펴보았습니다는 `Error` 의 이벤트 처리기는 `Global.asax` 파일을 전자 메일 메시지를 사용 하 여 개발자가 오류를 알립니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-237">This tutorial showed how to create an `Error` event handler in the `Global.asax` file that notifies developers of an error by means of an email message.</span></span>

<span data-ttu-id="b68b9-238">만들기는 `Error` 이벤트 처리기는 몇 가지 고유한 또는 사용자 지정 방식으로 처리 되지 않은 예외를 처리 해야 하는 경우에 유용 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-238">Creating an `Error` event handler is useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="b68b9-239">그러나 직접 만들어 `Error` 있습니다 몇 분 내에 설치 될 수 있는 무료 및 사용 하기 쉬운 오류 로깅 라이브러리에 이미 존재 이벤트 처리기 예외가 로그 또는 개발자에 게는의 시간을 가장 효율적으로 사용 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-239">However, creating your own `Error` event handler to log the exception or to notify a developer is not the most efficient use of your time as there already exist free and easy to use error logging libraries that can be setup in a matter of minutes.</span></span> <span data-ttu-id="b68b9-240">다음 두 자습서에서는 이러한 두 라이브러리를 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="b68b9-240">The next two tutorials examine two such libraries.</span></span>

<span data-ttu-id="b68b9-241">만족도 매우 프로그래밍!</span><span class="sxs-lookup"><span data-stu-id="b68b9-241">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b68b9-242">추가 정보</span><span class="sxs-lookup"><span data-stu-id="b68b9-242">Further Reading</span></span>

<span data-ttu-id="b68b9-243">이 자습서에 설명 된 항목에 대 한 자세한 내용은 다음 리소스를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="b68b9-243">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b68b9-244">ASP.NET HTTP 모듈 및 HTTP 처리기 개요</span><span class="sxs-lookup"><span data-stu-id="b68b9-244">ASP.NET HTTP Modules and HTTP Handlers Overview</span></span>](https://support.microsoft.com/kb/307985)
- [<span data-ttu-id="b68b9-245">정상적으로 처리 되지 않은 예외를 처리 하는 처리 되지 않은 예외-에 응답</span><span class="sxs-lookup"><span data-stu-id="b68b9-245">Gracefully Responding to Unhandled Exceptions - Processing Unhandled Exceptions</span></span>](http://aspnet.4guysfromrolla.com/articles/091306-1.aspx)
- [<span data-ttu-id="b68b9-246">`HttpApplication` 클래스 및 ASP.NET 응용 프로그램 개체</span><span class="sxs-lookup"><span data-stu-id="b68b9-246">`HttpApplication` Class and the ASP.NET Application Object</span></span>](http://www.eggheadcafe.com/articles/20030211.asp)
- [<span data-ttu-id="b68b9-247">HTTP 처리기 및 asp.net에서 HTTP 모듈</span><span class="sxs-lookup"><span data-stu-id="b68b9-247">HTTP Handlers and HTTP Modules in ASP.NET</span></span>](http://www.15seconds.com/Issue/020417.htm)
- [<span data-ttu-id="b68b9-248">ASP.NET에서 메일을 보내는 중</span><span class="sxs-lookup"><span data-stu-id="b68b9-248">Sending Email in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)
- [<span data-ttu-id="b68b9-249">이해의 `Global.asax` 파일</span><span class="sxs-lookup"><span data-stu-id="b68b9-249">Understanding the `Global.asax` File</span></span>](http://aspalliance.com/1114_Understanding_the_Globalasax_file.all)
- [<span data-ttu-id="b68b9-250">HTTP 모듈 및 처리기를 사용 하 여 플러그형 ASP.NET 구성 요소 만들기</span><span class="sxs-lookup"><span data-stu-id="b68b9-250">Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components</span></span>](https://msdn.microsoft.com/library/aa479332.aspx)
- [<span data-ttu-id="b68b9-251">ASP.NET 작업 `Global.asax` 파일</span><span class="sxs-lookup"><span data-stu-id="b68b9-251">Working with the ASP.NET `Global.asax` File</span></span>](http://articles.techrepublic.com.com/5100-10878_11-5771721.html)
- [<span data-ttu-id="b68b9-252">작업 `HttpApplication` 인스턴스</span><span class="sxs-lookup"><span data-stu-id="b68b9-252">Working with `HttpApplication` Instances</span></span>](https://msdn.microsoft.com/library/a0xez8f2.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="b68b9-253">[이전](displaying-a-custom-error-page-vb.md)
> [다음](logging-error-details-with-asp-net-health-monitoring-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b68b9-253">[Previous](displaying-a-custom-error-page-vb.md)
[Next](logging-error-details-with-asp-net-health-monitoring-vb.md)</span></span>
