---
title: ASP.NET Core 2.0을 2.1에서 마이그레이션
author: rick-anderson
description: 이 문서에서는 ASP.NET Core 2.0 앱 2.1로 마이그레이션할 경우의 기본 사항을 다룹니다.
ms.author: riande
ms.date: 07/25/2018
uid: migration/20_21
ms.openlocfilehash: caa679f80122e39f7e9a0f6e5f210d64bb73437f
ms.sourcegitcommit: 75bf5fdbfdcb6a7cfe8fe207b9ff37655ccbacd4
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/26/2018
ms.locfileid: "39275818"
---
# <a name="migrate-from-aspnet-core-20-to-21"></a><span data-ttu-id="feff3-103">ASP.NET Core 2.0을 2.1에서 마이그레이션</span><span class="sxs-lookup"><span data-stu-id="feff3-103">Migrate from ASP.NET Core 2.0 to 2.1</span></span>

<span data-ttu-id="feff3-104">작성자: [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="feff3-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="feff3-105">참조 [ASP.NET Core 2.1의 새로운 기능](xref:aspnetcore-2.1) ASP.NET Core 2.1의 새로운 기능에 대 한 개요입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-105">See [What's new in ASP.NET Core 2.1](xref:aspnetcore-2.1) for an overview of the new features in ASP.NET Core 2.1.</span></span>

<span data-ttu-id="feff3-106">이 기사의 내용:</span><span class="sxs-lookup"><span data-stu-id="feff3-106">This article:</span></span>

* <span data-ttu-id="feff3-107">ASP.NET Core 2.0 앱 2.1로 마이그레이션할 경우의 기본 사항을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-107">Covers the basics of migrating an ASP.NET Core 2.0 app to 2.1.</span></span>
* <span data-ttu-id="feff3-108">ASP.NET Core 웹 응용 프로그램 템플릿 변경 작업을 간략하게를 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-108">Provides an overview of the changes to the ASP.NET Core web application templates.</span></span>

<span data-ttu-id="feff3-109">2.1에서 변경 내용의 개요를 볼 수는 가장 빠른 방법은 무엇입니까?</span><span class="sxs-lookup"><span data-stu-id="feff3-109">A quick way to get an overview of the changes in 2.1 is to:</span></span>

* <span data-ttu-id="feff3-110">WebApp1 라는 ASP.NET Core 2.0 웹 앱을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-110">Create an ASP.NET Core 2.0 web app named WebApp1.</span></span>
* <span data-ttu-id="feff3-111">소스 제어 시스템에는 구성이 WebApp1를 커밋하십시오.</span><span class="sxs-lookup"><span data-stu-id="feff3-111">Commit the WebApp1 in a source control system.</span></span>
* <span data-ttu-id="feff3-112">WebApp1를 삭제 하 고 같은 위치에 대 한 구성이 WebApp1 라는 ASP.NET Core 2.1 웹 앱을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-112">Delete WebApp1 and create an ASP.NET Core 2.1 web app named WebApp1 in the same place.</span></span>
* <span data-ttu-id="feff3-113">2.1 버전에서 변경 내용을 검토 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-113">Review the changes in the 2.1 version.</span></span>

<span data-ttu-id="feff3-114">이 문서에서는 ASP.NET Core 2.1에 마이그레이션에 대 한 개요를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-114">This article provides an overview on migration to ASP.NET Core 2.1.</span></span> <span data-ttu-id="feff3-115">이 목록은 2.1 버전으로 마이그레이션하는 데 필요한 모든 변경 내용 포함 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-115">It doesn't contain a complete list of all changes needed to migrate to version 2.1.</span></span> <span data-ttu-id="feff3-116">일부 프로젝트는 프로젝트에 적용 된 수정 내용을 확인 하 고 프로젝트를 만들 때 선택한 옵션에 따라 추가 단계가 필요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-116">Some projects might require more steps depending on the options selected when the project was created and modifications made to the project.</span></span>

## <a name="update-the-project-file-to-use-21-versions"></a><span data-ttu-id="feff3-117">2.1 버전을 사용하도록 프로젝트 파일 업데이트</span><span class="sxs-lookup"><span data-stu-id="feff3-117">Update the project file to use 2.1 versions</span></span>

<span data-ttu-id="feff3-118">프로젝트 파일을 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-118">Update the project file:</span></span>

* <span data-ttu-id="feff3-119">프로젝트 파일을 업데이트 하 여.NET Core 2.1에 대상 프레임 워크를 변경할 `<TargetFramework>netcoreapp2.1</TargetFramework>`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-119">Change the target framework to .NET Core 2.1 by updating the project file to `<TargetFramework>netcoreapp2.1</TargetFramework>`.</span></span>
* <span data-ttu-id="feff3-120">에 대 한 패키지 참조를 바꿀 `Microsoft.AspNetCore.All` 에 대 한 패키지 참조를 사용 하 여 `Microsoft.AspNetCore.App`입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-120">Replace the package reference for `Microsoft.AspNetCore.All` with a package reference for `Microsoft.AspNetCore.App`.</span></span> <span data-ttu-id="feff3-121">제거 된 종속성을 추가 해야 `Microsoft.AspNetCore.All`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-121">You may need to add dependencies that were removed from `Microsoft.AspNetCore.All`.</span></span> <span data-ttu-id="feff3-122">자세한 내용은 <xref:fundamentals/metapackage#migrate> 및 <xref:fundamentals/metapackage-app>를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="feff3-122">For more information, see <xref:fundamentals/metapackage#migrate> and <xref:fundamentals/metapackage-app>.</span></span> <span data-ttu-id="feff3-123">.NET Framework를 대상으로 하는 앱의 경우:</span><span class="sxs-lookup"><span data-stu-id="feff3-123">For apps that target the .NET Framework:</span></span>
  * <span data-ttu-id="feff3-124">메타 패키지 참조 하는 대신 개별 패키지 참조를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-124">Add individual package references instead of a metapackage reference.</span></span>
  * <span data-ttu-id="feff3-125">2.1에 대 한 각 패키지 참조를 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-125">Update each package reference to 2.1.</span></span>
* <span data-ttu-id="feff3-126">에 대 한 참조를 제거 **&lt;DotNetCliToolReference&gt;** 다음 패키지에 대 한 요소입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-126">Remove references to **&lt;DotNetCliToolReference&gt;** elements for the following packages.</span></span> <span data-ttu-id="feff3-127">이러한 도구는.NET Core CLI에서 기본적으로 제공 되어와 별도로 설치할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-127">These tools are bundled by default in the .NET Core CLI and don't need to be installed separately.</span></span>
  * <span data-ttu-id="feff3-128">Microsoft.DotNet.Watcher.Tools (`dotnet watch`)</span><span class="sxs-lookup"><span data-stu-id="feff3-128">Microsoft.DotNet.Watcher.Tools (`dotnet watch`)</span></span>
  * <span data-ttu-id="feff3-129">Microsoft.EntityFrameworkCore.Tools.DotNet (`dotnet ef`)</span><span class="sxs-lookup"><span data-stu-id="feff3-129">Microsoft.EntityFrameworkCore.Tools.DotNet (`dotnet ef`)</span></span>
  * <span data-ttu-id="feff3-130">Microsoft.Extensions.Caching.SqlConfig.Tools (`dotnet sql-cache`)</span><span class="sxs-lookup"><span data-stu-id="feff3-130">Microsoft.Extensions.Caching.SqlConfig.Tools  (`dotnet sql-cache`)</span></span>
  * <span data-ttu-id="feff3-131">Microsoft.Extensions.SecretManager.Tools (`dotnet user-secrets`)</span><span class="sxs-lookup"><span data-stu-id="feff3-131">Microsoft.Extensions.SecretManager.Tools (`dotnet user-secrets`)</span></span>
* <span data-ttu-id="feff3-132">선택 사항: 제거할 수 있습니다 합니다 **&lt;DotNetCliToolReference&gt;** 요소에 대 한 `Microsoft.VisualStudio.Web.CodeGeneration.Tools`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-132">Optional: you can remove the **&lt;DotNetCliToolReference&gt;** element for `Microsoft.VisualStudio.Web.CodeGeneration.Tools`.</span></span> <span data-ttu-id="feff3-133">이 도구를 실행 하 여 전역적으로 설치 된 버전으로 바꿀 수 있습니다 `dotnet tool install -g dotnet-aspnet-codegenerator`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-133">You can replace this tool with a globally installed version by running `dotnet tool install -g dotnet-aspnet-codegenerator`.</span></span>

<span data-ttu-id="feff3-134">다음 태그는 2.0 프로젝트 템플릿에서 생성 된 파일을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-134">The following markup shows the template-generated 2.0 project file:</span></span>

[!code-xml[Main](20_21/sample/WebApp20.csproj)]

<span data-ttu-id="feff3-135">다음 태그 2.1 프로젝트 템플릿에서 생성 된 파일을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-135">The following markup shows the template-generated 2.1 project file:</span></span>

[!code-xml[Main](20_21/sample/WebApp21.csproj)]

## <a name="rules-for-projects-targeting-the-shared-runtime"></a><span data-ttu-id="feff3-136">공유 런타임을 대상으로 하는 프로젝트에 대 한 규칙</span><span class="sxs-lookup"><span data-stu-id="feff3-136">Rules for projects targeting the shared runtime</span></span>

<span data-ttu-id="feff3-137">ASP.NET Core에는 다음 공유 런타임을 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-137">ASP.NET Core includes the following shared runtimes:</span></span>

* [<span data-ttu-id="feff3-138">Microsoft.AspNetCore.App</span><span class="sxs-lookup"><span data-stu-id="feff3-138">Microsoft.AspNetCore.App</span></span>](xref:fundamentals/metapackage-app)
* [<span data-ttu-id="feff3-139">Microsoft.AspNetCore.All</span><span class="sxs-lookup"><span data-stu-id="feff3-139">Microsoft.AspNetCore.All</span></span>](xref:fundamentals/metapackage)

<span data-ttu-id="feff3-140">패키지 참조에 의해 지정 된 버전은는 *최소한* 버전입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-140">The version specified by the package reference is the *minimum required* version.</span></span> <span data-ttu-id="feff3-141">이러한 패키지의 버전은 2.1.0에만 있는 컴퓨터에서 실행 되지 않습니다 2.1.1 참조는 프로젝트 예를 들어, 런타임을 설치 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-141">For example, a project referencing the 2.1.1 versions of these packages won't run on a machine with only the 2.1.0 runtime installed.</span></span>

<span data-ttu-id="feff3-142">공유 런타임을 대상으로 하는 프로젝트에 대 한 알려진된 문제:</span><span class="sxs-lookup"><span data-stu-id="feff3-142">Known issues for projects targeting the shared runtime:</span></span>

* <span data-ttu-id="feff3-143">사용 하 여 `Microsoft.AspNetCore.App` Entity Framework Core 2.1.1 사용 하 여 2.1.0 하면 패키지 충돌로 인해 NuGet 복원이 실패 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-143">Using `Microsoft.AspNetCore.App` 2.1.0 with Entity Framework Core 2.1.1 causes NuGet restore failures due to package conflicts.</span></span> <span data-ttu-id="feff3-144">업그레이드 하는 권장된 솔루션 `Microsoft.AspNetCore.App` 2.1.1 하 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-144">The recommended solution is to upgrade `Microsoft.AspNetCore.App` to 2.1.1.</span></span> <span data-ttu-id="feff3-145">자세한 내용은 [Microsoft.AspNetCore.App를 사용 하 여 종속성을 공유 하는 패키지는 패치 버전을 참조할 수 없습니다](https://github.com/aspnet/Universe/issues/1180)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-145">For more information, see [Packages that share dependencies with Microsoft.AspNetCore.App cannot reference patch versions](https://github.com/aspnet/Universe/issues/1180).</span></span>
* <span data-ttu-id="feff3-146">사용 해야 하는 모든 프로젝트 `Microsoft.AspNetCore.All` 나 `Microsoft.AspNetCore.App` 사용 하 여 다른 프로젝트에 대 한 프로젝트 참조를 포함 하는 경우에 프로젝트 파일에서 패키지의 패키지 참조를 추가 해야 `Microsoft.AspNetCore.All` 또는 `Microsoft.AspNetCore.App`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-146">All projects that must use `Microsoft.AspNetCore.All` or `Microsoft.AspNetCore.App` should add a package reference for the package in the project file, even if they contain a project reference to another project using `Microsoft.AspNetCore.All` or `Microsoft.AspNetCore.App`.</span></span>

  <span data-ttu-id="feff3-147">예제:</span><span class="sxs-lookup"><span data-stu-id="feff3-147">Example:</span></span>

  * <span data-ttu-id="feff3-148">`MyApp` 에 대 한 패키지 참조가 `Microsoft.AspNetCore.App`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-148">`MyApp` has a package reference to `Microsoft.AspNetCore.App`.</span></span>
  * <span data-ttu-id="feff3-149">`MyApp.Tests` 에 대 한 프로젝트 참조가 `MyApp.csproj`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-149">`MyApp.Tests` has a project reference to `MyApp.csproj`.</span></span>
  
  <span data-ttu-id="feff3-150">패키지 참조를 추가할 `Microsoft.AspNetCore.App` 에 `MyApp.Tests`입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-150">Add a package reference for `Microsoft.AspNetCore.App` to `MyApp.Tests`.</span></span> <span data-ttu-id="feff3-151">자세한 내용은 [설정 하기가 어렵습니다 통합 테스트 및 공유 프레임 워크 서비스에서 중단 될 수 있습니다](https://github.com/aspnet/Home/issues/3156)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-151">For more information, see [Integration testing is hard to set up and may break on shared framework servicing](https://github.com/aspnet/Home/issues/3156).</span></span>

## <a name="update-to-the-21-docker-images"></a><span data-ttu-id="feff3-152">2.1 Docker 이미지를 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-152">Update to the 2.1 Docker images</span></span>

<span data-ttu-id="feff3-153">ASP.NET Core 2.1에서 Docker 이미지를 마이그레이션 합니다 [dotnet/dotnet-docker GitHub 리포지토리](https://github.com/dotnet/dotnet-docker)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-153">In ASP.NET Core 2.1, the Docker images migrated to the [dotnet/dotnet-docker GitHub repository](https://github.com/dotnet/dotnet-docker).</span></span> <span data-ttu-id="feff3-154">다음 표에서 Docker 이미지 및 태그 변경을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-154">The following table shows the Docker image and tag changes:</span></span>

|<span data-ttu-id="feff3-155">2.0</span><span class="sxs-lookup"><span data-stu-id="feff3-155">2.0</span></span>      |<span data-ttu-id="feff3-156">2.1</span><span class="sxs-lookup"><span data-stu-id="feff3-156">2.1</span></span>      |
|---------|---------|
|<span data-ttu-id="feff3-157">microsoft / aspnetcore:2.0</span><span class="sxs-lookup"><span data-stu-id="feff3-157">microsoft/aspnetcore:2.0</span></span>        |<span data-ttu-id="feff3-158">microsoft / dotnet:2.1-aspnetcore-런타임</span><span class="sxs-lookup"><span data-stu-id="feff3-158">microsoft/dotnet:2.1-aspnetcore-runtime</span></span> |
|<span data-ttu-id="feff3-159">microsoft/aspnetcore-빌드: 2.0</span><span class="sxs-lookup"><span data-stu-id="feff3-159">microsoft/aspnetcore-build:2.0</span></span>  |<span data-ttu-id="feff3-160">microsoft / dotnet:2.1-sdk</span><span class="sxs-lookup"><span data-stu-id="feff3-160">microsoft/dotnet:2.1-sdk</span></span> |

<span data-ttu-id="feff3-161">변경 된 `FROM` 줄에 *Dockerfile* 2.1 이전 테이블의 열에 새 이미지 이름과 태그를 사용 하 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-161">Change the `FROM` lines in your *Dockerfile* to use the new image names and tags in the preceding table's 2.1 column.</span></span> <span data-ttu-id="feff3-162">자세한 내용은 [aspnetcore docker 리포지토리에서 dotnet로 마이그레이션](https://github.com/aspnet/Announcements/issues/298)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-162">For more information, see [Migrating from aspnetcore docker repos to dotnet](https://github.com/aspnet/Announcements/issues/298).</span></span>

## <a name="changes-to-take-advantage-of-the-new-code-based-idioms-that-are-recommended-in-aspnet-core-21"></a><span data-ttu-id="feff3-163">ASP.NET Core 2.1에서 권장 하는 새 코드 기반 관용구를 활용 하기 위해 변경 내용</span><span class="sxs-lookup"><span data-stu-id="feff3-163">Changes to take advantage of the new code-based idioms that are recommended in ASP.NET Core 2.1</span></span>

### <a name="changes-to-main"></a><span data-ttu-id="feff3-164">Main에 대 한 변경 내용</span><span class="sxs-lookup"><span data-stu-id="feff3-164">Changes to Main</span></span>

<span data-ttu-id="feff3-165">다음 그림은 생성 된 템플릿 변경 내용을 보여 *Program.cs* 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-165">The following images show the changes made to the templated generated *Program.cs* file.</span></span>

![이전 버전 간 차이점](20_21/_static/main20.png)

<span data-ttu-id="feff3-167">위의 이미지는 빨간색에서 삭제를 사용 하 여 2.0 버전을 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-167">The preceding image shows the 2.0 version with the deletions in red.</span></span>

<span data-ttu-id="feff3-168">다음 이미지에서는 2.1 코드를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-168">The following image shows the 2.1 code.</span></span> <span data-ttu-id="feff3-169">녹색의 코드를 대체 2.0 버전:</span><span class="sxs-lookup"><span data-stu-id="feff3-169">The code in green replaced the 2.0 version:</span></span>

![새 버전 간 차이점](20_21/_static/main21.png)

<span data-ttu-id="feff3-171">다음 코드를 2.1 버전을 보여 줍니다 *Program.cs*:</span><span class="sxs-lookup"><span data-stu-id="feff3-171">The following code shows the 2.1 version of *Program.cs*:</span></span>

[!code-csharp[Main](20_21/sample/Program.cs?name=snippet)]

<span data-ttu-id="feff3-172">새 `Main` 에 대 한 호출을 대체 `BuildWebHost` 사용 하 여 [CreateWebHostBuilder](/dotnet/api/microsoft.aspnetcore.mvc.testing.webapplicationfactory-1.createwebhostbuilder)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-172">The new `Main` replaces the call to `BuildWebHost` with [CreateWebHostBuilder](/dotnet/api/microsoft.aspnetcore.mvc.testing.webapplicationfactory-1.createwebhostbuilder).</span></span> <span data-ttu-id="feff3-173">[IWebHostBuilder](/dotnet/api/microsoft.aspnetcore.hosting.iwebhostbuilder) 새 지원 하기 위해 추가 되었습니다 [통합 테스트 인프라](xref:test/integration-tests)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-173">[IWebHostBuilder](/dotnet/api/microsoft.aspnetcore.hosting.iwebhostbuilder) was added to support a new [integration test infrastructure](xref:test/integration-tests).</span></span>

### <a name="changes-to-startup"></a><span data-ttu-id="feff3-174">시작 변경</span><span class="sxs-lookup"><span data-stu-id="feff3-174">Changes to Startup</span></span>

<span data-ttu-id="feff3-175">다음 코드에서는 2.1 템플릿 생성 된 코드 변경 내용을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-175">The following code shows the changes to 2.1 template generated code.</span></span> <span data-ttu-id="feff3-176">모든 변경 내용을 제외 하는 코드를 새로 추가 된 `UseBrowserLink` 제거 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-176">All changes are newly added code, except that `UseBrowserLink` has been removed:</span></span>

[!code-csharp[Main](20_21/sample/Startup.cs?highlight=3,4,21-26,30,42,45,47)]

<span data-ttu-id="feff3-177">위의 코드 변경 내용에 자세히 설명 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-177">The preceding code changes are detailed in:</span></span>

* <span data-ttu-id="feff3-178">[ASP.NET Core에서 지 원하는 GDPR](xref:security/gdpr) 에 대 한 `CookiePolicyOptions` 고 `UseCookiePolicy`입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-178">[GDPR support in ASP.NET Core](xref:security/gdpr) for `CookiePolicyOptions` and `UseCookiePolicy`.</span></span>
* <span data-ttu-id="feff3-179">[HTTP 엄격한 전송 보안 (HSTS) 프로토콜](xref:security/enforcing-ssl#http-strict-transport-security-protocol-hsts) 에 대 한 `UseHsts`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-179">[HTTP Strict Transport Security Protocol (HSTS)](xref:security/enforcing-ssl#http-strict-transport-security-protocol-hsts) for `UseHsts`.</span></span>
* <span data-ttu-id="feff3-180">[HTTPS가 필요](xref:security/enforcing-ssl#require-https) 에 대 한 `UseHttpsRedirection`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-180">[Require HTTPS](xref:security/enforcing-ssl#require-https) for `UseHttpsRedirection`.</span></span>
* <span data-ttu-id="feff3-181">[SetCompatibilityVersion](xref:fundamentals/startup#setcompatibilityversion) 에 대 한 `SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-181">[SetCompatibilityVersion](xref:fundamentals/startup#setcompatibilityversion) for `SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`.</span></span>

## <a name="changes-to-authentication-code"></a><span data-ttu-id="feff3-182">인증 코드를 변경</span><span class="sxs-lookup"><span data-stu-id="feff3-182">Changes to authentication code</span></span>

<span data-ttu-id="feff3-183">ASP.NET Core 2.1에서 제공 [ASP.NET Core Id](xref:security/authentication/identity) 으로 [Razor 클래스 라이브러리](xref:razor-pages/ui-class) (RCL).</span><span class="sxs-lookup"><span data-stu-id="feff3-183">ASP.NET Core 2.1 provides [ASP.NET Core Identity](xref:security/authentication/identity) as a [Razor Class Library](xref:razor-pages/ui-class) (RCL).</span></span>

<span data-ttu-id="feff3-184">2.1 기본 Identity UI 하면 2.0 버전에 비해 중요 한 새 기능이 현재 제공 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-184">The default 2.1 Identity UI doesn't currently provide significant new features over the 2.0 version.</span></span> <span data-ttu-id="feff3-185">RCL 패키지를 사용 하 여 Identity를 대체 하는 것은 선택 사항입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-185">Replacing Identity with the RCL package is optional.</span></span> <span data-ttu-id="feff3-186">템플릿 대체 하는 이점 RCL 버전을 사용 하 여 코드를 포함 하는 Identity를 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-186">The advantages to replacing the template generated Identity code with the RCL version include:</span></span>

* <span data-ttu-id="feff3-187">많은 파일이 소스 트리에 외부로 이동 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-187">Many files are moved out of your source tree.</span></span>
* <span data-ttu-id="feff3-188">에 포함 된 모든 버그 수정 또는 Id로 새 기능을 [Microsoft.AspNetCore.App 메타 패키지](xref:fundamentals/metapackage-app)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-188">Any bug fixes or new features to Identity are included in the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app).</span></span> <span data-ttu-id="feff3-189">업데이트 된 Id를 자동으로 가져올 때 `Microsoft.AspNetCore.App` 업데이트 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-189">You automatically get the updated Identity when `Microsoft.AspNetCore.App` is updated.</span></span>

<span data-ttu-id="feff3-190">Trivial이 아닌 변경한 경우 템플릿 변경 내용을 Id 코드를 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-190">If you've made non-trivial changes to the template generated Identity code:</span></span>

* <span data-ttu-id="feff3-191">위의 장점 그럴 **하지** 변환할 양쪽 맞춤을 RCL 버전.</span><span class="sxs-lookup"><span data-stu-id="feff3-191">The preceding advantages probably do **not** justify converting to the the RCL version.</span></span>
* <span data-ttu-id="feff3-192">ASP.NET Core 2.0 Id 코드를 유지할 수 있습니다, 완전히 지원 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-192">You can keep your ASP.NET Core 2.0 Identity code, it's fully supported.</span></span>

<span data-ttu-id="feff3-193">Identity 2.1 끝점을 노출 합니다 `Identity` 영역입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-193">Identity 2.1 exposes endpoints with the `Identity` area.</span></span> <span data-ttu-id="feff3-194">예를 들어, 다음 표에서 2.1을 2.0에서 변경 하는 Identity 끝점의 예를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-194">For example, the follow table shows examples of Identity endpoints that change from 2.0 to 2.1:</span></span>

| <span data-ttu-id="feff3-195">2.0 URL</span><span class="sxs-lookup"><span data-stu-id="feff3-195">2.0 URL</span></span>         | <span data-ttu-id="feff3-196">2.1 URL</span><span class="sxs-lookup"><span data-stu-id="feff3-196">2.1 URL</span></span> |
| --------------- | ------------ |
| <span data-ttu-id="feff3-197">/ Account/Login</span><span class="sxs-lookup"><span data-stu-id="feff3-197">/Account/Login</span></span>  | <span data-ttu-id="feff3-198">/ I d/계정/로그인</span><span class="sxs-lookup"><span data-stu-id="feff3-198">/Identity/Account/Login</span></span> |
| <span data-ttu-id="feff3-199">/ 계정/로그 아웃</span><span class="sxs-lookup"><span data-stu-id="feff3-199">/Account/Logout</span></span> | <span data-ttu-id="feff3-200">/ Identity/계정/로그 아웃</span><span class="sxs-lookup"><span data-stu-id="feff3-200">/Identity/Account/Logout</span></span> |
| <span data-ttu-id="feff3-201">계정/관리</span><span class="sxs-lookup"><span data-stu-id="feff3-201">/Account/Manage</span></span> | <span data-ttu-id="feff3-202">Identity/계정/관리</span><span class="sxs-lookup"><span data-stu-id="feff3-202">/Identity/Account/Manage</span></span> |

<span data-ttu-id="feff3-203">2.0을 바꾸고 코드 Id를 사용 하는 응용 프로그램 Identity Url 고려해 야 할 2.1 Identity 라이브러리 필요를 사용 하 여 Identity UI가 `/Identity` 세그먼트 앞 Uri에 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-203">Applications that have code using Identity and replace 2.0 Identity UI with the 2.1 Identity Library need to take into account Identity URLs have `/Identity` segment prepended to the URIs.</span></span> <span data-ttu-id="feff3-204">예를 들어 리디렉션을을 설정 하는 Id 끝점이 새 처리 하는 한 가지 방법은 `/Account/Login` 에 `/Identity/Account/Login`입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-204">One way to handle the new Identity endpoints is to set up redirects, for example from `/Account/Login` to `/Identity/Account/Login`.</span></span>

### <a name="update-identity-to-version-21"></a><span data-ttu-id="feff3-205">업데이트 Id를 버전 2.1</span><span class="sxs-lookup"><span data-stu-id="feff3-205">Update Identity to version 2.1</span></span>

<span data-ttu-id="feff3-206">다음 옵션은 2.1 Id 업데이트를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-206">The following options are available to update Identity to 2.1.</span></span>

* <span data-ttu-id="feff3-207">Identity UI 2.0 코드 변경 없이 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-207">Use the Identity UI 2.0 code with no changes.</span></span> <span data-ttu-id="feff3-208">Identity UI 2.0 코드를 사용 하 여 완전히 지원 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-208">Using Identity UI 2.0 code is fully supported.</span></span> <span data-ttu-id="feff3-209">생성 된 Id 코드에 중요 한 변경 내용이 적용 된 경우 이것이 좋은 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-209">This is a good approach when significant changes have been made to the generated Identity code.</span></span>
* <span data-ttu-id="feff3-210">기존 Identity 2.0 코드를 삭제 하 고 [스 캐 폴드 Identity](xref:security/authentication/scaffold-identity) 프로젝트로 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-210">Delete your existing Identity 2.0 code and [Scaffold Identity](xref:security/authentication/scaffold-identity) into your project.</span></span> <span data-ttu-id="feff3-211">프로젝트를 사용 합니다 [ASP.NET Core Id](xref:security/authentication/identity) [Razor 클래스 라이브러리](xref:razor-pages/ui-class)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-211">Your project will use the [ASP.NET Core Identity](xref:security/authentication/identity) [Razor Class Library](xref:razor-pages/ui-class).</span></span> <span data-ttu-id="feff3-212">코드와 수정한 Identity UI 코드에 대 한 UI를 생성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-212">You can generate code and UI for any of the Identity UI code that you modified.</span></span> <span data-ttu-id="feff3-213">UI 코드를 새로 스 캐 폴드 된 코드 변경 내용을 적용 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-213">Apply your code changes to the newly scaffolded UI code.</span></span>
* <span data-ttu-id="feff3-214">기존 Identity 2.0 코드를 삭제 하 고 [스 캐 폴드 Identity](xref:security/authentication/scaffold-identity) 옵션을 사용 하 여 프로젝트에 **모든 파일 재정의**합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-214">Delete your existing Identity 2.0 code and [Scaffold Identity](xref:security/authentication/scaffold-identity) into your project with the option to **Override all files**.</span></span>

### <a name="replace-identity-20-ui-with-the-identity-21-razor-class-library"></a><span data-ttu-id="feff3-215">Identity 2.0 대체 Identity 2.1 Razor 클래스 라이브러리를 사용 하 여 UI</span><span class="sxs-lookup"><span data-stu-id="feff3-215">Replace Identity 2.0 UI with the Identity 2.1 Razor Class Library</span></span>

<span data-ttu-id="feff3-216">이 섹션에서는 ASP.NET Core 2.0 템플릿 생성 Identity 코드를 대체 하는 단계를 설명 합니다 [ASP.NET Core Id](xref:security/authentication/identity) [Razor 클래스 라이브러리](xref:razor-pages/ui-class)합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-216">This section outlines the steps to replace the ASP.NET Core 2.0 template generated Identity code with the [ASP.NET Core Identity](xref:security/authentication/identity) [Razor Class Library](xref:razor-pages/ui-class).</span></span> <span data-ttu-id="feff3-217">Razor 페이지 프로젝트의 경우 다음 단계는 하지만 MVC 프로젝트에 대 한 접근 방법이 비슷합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-217">The following steps are for a Razor Pages project, but the approach for an MVC project is similar.</span></span>

* <span data-ttu-id="feff3-218">확인 된 [2.1 버전을 사용 하도록 프로젝트 파일이 업데이트 됩니다](#update-the-project-file-to-use-21-versions)</span><span class="sxs-lookup"><span data-stu-id="feff3-218">Verify the [project file is updated to use 2.1 versions](#update-the-project-file-to-use-21-versions)</span></span>
* <span data-ttu-id="feff3-219">다음 폴더 및 그 안에 모든 파일을 삭제 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-219">Delete the following folders and all the files in them:</span></span>
  * <span data-ttu-id="feff3-220">*Controllers*</span><span class="sxs-lookup"><span data-stu-id="feff3-220">*Controllers*</span></span>
  * <span data-ttu-id="feff3-221">*페이지/계정 /*</span><span class="sxs-lookup"><span data-stu-id="feff3-221">*Pages/Account/*</span></span>
  * <span data-ttu-id="feff3-222">*확장*</span><span class="sxs-lookup"><span data-stu-id="feff3-222">*Extensions*</span></span>
* <span data-ttu-id="feff3-223">프로젝트를 빌드합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-223">Build the project.</span></span>
* <span data-ttu-id="feff3-224">[Identity를 스 캐 폴드](xref:security/authentication/scaffold-identity) 프로젝트로:</span><span class="sxs-lookup"><span data-stu-id="feff3-224">[Scaffold Identity](xref:security/authentication/scaffold-identity) into your project:</span></span>
  * <span data-ttu-id="feff3-225">기존 프로젝트를 선택 *_Layout.cshtml* 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-225">Select the projects exiting *_Layout.cshtml* file.</span></span>
  * <span data-ttu-id="feff3-226">선택 된 **+** 아이콘의 오른쪽에는 **데이터 컨텍스트 클래스**합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-226">Select the **+** icon on the right side of the **Data context class**.</span></span> <span data-ttu-id="feff3-227">기본 이름을 적용 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-227">Accept the default name.</span></span>
  * <span data-ttu-id="feff3-228">선택 **추가** 새 데이터 컨텍스트 클래스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-228">Select **Add** to create a new Data context class.</span></span> <span data-ttu-id="feff3-229">새 데이터 컨텍스트를 만드는 것이 스 캐 폴드에 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-229">Creating a new data context is required for to scaffold.</span></span> <span data-ttu-id="feff3-230">다음 섹션에서 새 데이터 컨텍스트를 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-230">You remove the new data context in the next section.</span></span>

### <a name="update-after-scaffolding-identity"></a><span data-ttu-id="feff3-231">Identity를 스 캐 폴딩 후 업데이트</span><span class="sxs-lookup"><span data-stu-id="feff3-231">Update after scaffolding Identity</span></span>

* <span data-ttu-id="feff3-232">생성 된 Identity 스 캐 폴더를 삭제 `IdentityDbContext` 파생 클래스에는 *영역/Id/데이터/* 폴더.</span><span class="sxs-lookup"><span data-stu-id="feff3-232">Delete the Identity scaffolder generated `IdentityDbContext` derived class in the *Areas/Identity/Data/* folder.</span></span>
* <span data-ttu-id="feff3-233">삭제 *Areas/Identity/IdentityHostingStartup.cs*</span><span class="sxs-lookup"><span data-stu-id="feff3-233">Delete *Areas/Identity/IdentityHostingStartup.cs*</span></span>
* <span data-ttu-id="feff3-234">업데이트를 *_LoginPartial.cshtml* 파일:</span><span class="sxs-lookup"><span data-stu-id="feff3-234">Update the *_LoginPartial.cshtml* file:</span></span>
  * <span data-ttu-id="feff3-235">이동할 *Pages/_LoginPartial.cshtml* 에 *Pages/Shared/_LoginPartial.cshtml*</span><span class="sxs-lookup"><span data-stu-id="feff3-235">Move *Pages/_LoginPartial.cshtml* to *Pages/Shared/_LoginPartial.cshtml*</span></span>
  * <span data-ttu-id="feff3-236">추가 `asp-area="Identity"` 양식과 앵커 링크를 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-236">Add `asp-area="Identity"` to the form and anchor links.</span></span>
  * <span data-ttu-id="feff3-237">업데이트 된 `<form />` 요소 `<form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/Index", new { area = "" })" method="post" id="logoutForm" class="navbar-right">`</span><span class="sxs-lookup"><span data-stu-id="feff3-237">Update the `<form />` element to `<form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/Index", new { area = "" })" method="post" id="logoutForm" class="navbar-right">`</span></span>

  <span data-ttu-id="feff3-238">다음 코드는 업데이트 된 보여줍니다 *_LoginPartial.cshtml* 파일:</span><span class="sxs-lookup"><span data-stu-id="feff3-238">The following code shows the updated *_LoginPartial.cshtml* file:</span></span>

  [!code-cshtml[Main](20_21/sample/_LoginPartial.cshtml?highlight=8,11,22,23)]

<span data-ttu-id="feff3-239">업데이트 `ConfigureServices` 다음 코드를 사용 하 여:</span><span class="sxs-lookup"><span data-stu-id="feff3-239">Update `ConfigureServices` with the following code:</span></span>

[!code-csharp[Main](20_21/sample/Startup2.cs?name=snippet)]

## <a name="changes-to-razor-pages-projects-razor-files"></a><span data-ttu-id="feff3-240">Razor 페이지 프로젝트 Razor 파일 변경</span><span class="sxs-lookup"><span data-stu-id="feff3-240">Changes to Razor Pages projects Razor files</span></span>

### <a name="the-layout-file"></a><span data-ttu-id="feff3-241">레이아웃 파일</span><span class="sxs-lookup"><span data-stu-id="feff3-241">The layout file</span></span>

* <span data-ttu-id="feff3-242">이동할 *pages/_layout.cshtml* 에 *Pages/Shared/_Layout.cshtml*</span><span class="sxs-lookup"><span data-stu-id="feff3-242">Move *Pages/_Layout.cshtml* to *Pages/Shared/_Layout.cshtml*</span></span>
* <span data-ttu-id="feff3-243">합니다 *Layout.cshtml* 파일에 다음과 같이 변경 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-243">The *Layout.cshtml* file has the following changes:</span></span>

  * <span data-ttu-id="feff3-244">`<partial name="_CookieConsentPartial" />` 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-244">`<partial name="_CookieConsentPartial" />` is added.</span></span> <span data-ttu-id="feff3-245">자세한 내용은 [ASP.NET Core에서 GDPR 지원](xref:security/gdpr)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="feff3-245">For more information, see [GDPR support in ASP.NET Core](xref:security/gdpr).</span></span>
  * <span data-ttu-id="feff3-246">3.3.1 2.2.0에서 jQuery 변경</span><span class="sxs-lookup"><span data-stu-id="feff3-246">jQuery changes from 2.2.0 to 3.3.1</span></span>

### <a name="validationscriptspartialcshtml"></a><span data-ttu-id="feff3-247">_ValidationScriptsPartial.cshtml</span><span class="sxs-lookup"><span data-stu-id="feff3-247">_ValidationScriptsPartial.cshtml</span></span>

* <span data-ttu-id="feff3-248">*_Validationscriptspartial.cshtml* 이동 *Pages/Shared/_ValidationScriptsPartial.cshtml*</span><span class="sxs-lookup"><span data-stu-id="feff3-248">*Pages/_ValidationScriptsPartial.cshtml* moves to  *Pages/Shared/_ValidationScriptsPartial.cshtml*</span></span>
* <span data-ttu-id="feff3-249">*jquery.validate/1.14.0* 변경 *jquery.validate/1.17.0*</span><span class="sxs-lookup"><span data-stu-id="feff3-249">*jquery.validate/1.14.0* changes to *jquery.validate/1.17.0*</span></span>

### <a name="new-files"></a><span data-ttu-id="feff3-250">새 파일</span><span class="sxs-lookup"><span data-stu-id="feff3-250">New files</span></span>

<span data-ttu-id="feff3-251">다음 파일이 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-251">The following files are added:</span></span>

* <span data-ttu-id="feff3-252">*Privacy.cshtml*</span><span class="sxs-lookup"><span data-stu-id="feff3-252">*Privacy.cshtml*</span></span>
* <span data-ttu-id="feff3-253">*Privacy.cshtml.cs*</span><span class="sxs-lookup"><span data-stu-id="feff3-253">*Privacy.cshtml.cs*</span></span>

<span data-ttu-id="feff3-254">참조 [ASP.NET Core에서 GDPR 지원](xref:security/gdpr) 앞의 파일에 대 한 정보에 대 한 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-254">See [GDPR support in ASP.NET Core](xref:security/gdpr) for information on the preceding files.</span></span>

## <a name="changes-to-mvc-projects-razor-files"></a><span data-ttu-id="feff3-255">Razor 파일을 MVC 프로젝트 변경</span><span class="sxs-lookup"><span data-stu-id="feff3-255">Changes to MVC projects Razor files</span></span>

### <a name="the-layout-file"></a><span data-ttu-id="feff3-256">레이아웃 파일</span><span class="sxs-lookup"><span data-stu-id="feff3-256">The layout file</span></span>

<span data-ttu-id="feff3-257">합니다 *Layout.cshtml* 파일에 다음과 같이 변경 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-257">The *Layout.cshtml* file has the following changes:</span></span>

* <span data-ttu-id="feff3-258">`<partial name="_CookieConsentPartial" />` 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-258">`<partial name="_CookieConsentPartial" />` is added.</span></span>
* <span data-ttu-id="feff3-259">3.3.1 2.2.0에서 jQuery 변경</span><span class="sxs-lookup"><span data-stu-id="feff3-259">jQuery changes from 2.2.0 to 3.3.1</span></span>

### <a name="validationscriptspartialcshtml"></a><span data-ttu-id="feff3-260">_ValidationScriptsPartial.cshtml</span><span class="sxs-lookup"><span data-stu-id="feff3-260">_ValidationScriptsPartial.cshtml</span></span>

<span data-ttu-id="feff3-261">*jquery.validate/1.14.0* 변경 *jquery.validate/1.17.0*</span><span class="sxs-lookup"><span data-stu-id="feff3-261">*jquery.validate/1.14.0* changes to *jquery.validate/1.17.0*</span></span>

### <a name="new-files-and-action-methods"></a><span data-ttu-id="feff3-262">새 파일 및 작업 메서드</span><span class="sxs-lookup"><span data-stu-id="feff3-262">New files and action methods</span></span>

<span data-ttu-id="feff3-263">다음 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-263">The following are added:</span></span>

* <span data-ttu-id="feff3-264">*Views/Home/Privacy.cshtml*</span><span class="sxs-lookup"><span data-stu-id="feff3-264">*Views/Home/Privacy.cshtml*</span></span>
* <span data-ttu-id="feff3-265">`Privacy` 작업 메서드가 Home 컨트롤러에 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-265">The `Privacy` action method is added to the Home controller.</span></span>

<span data-ttu-id="feff3-266">참조 [ASP.NET Core에서 GDPR 지원](xref:security/gdpr) 앞의 파일에 대 한 정보에 대 한 합니다.</span><span class="sxs-lookup"><span data-stu-id="feff3-266">See [GDPR support in ASP.NET Core](xref:security/gdpr) for information on the preceding files.</span></span>

## <a name="additional-changes"></a><span data-ttu-id="feff3-267">추가 변경 내용</span><span class="sxs-lookup"><span data-stu-id="feff3-267">Additional changes</span></span>

* [<span data-ttu-id="feff3-268">SetCompatibilityVersion</span><span class="sxs-lookup"><span data-stu-id="feff3-268">SetCompatibilityVersion</span></span>](xref:fundamentals/startup#setcompatibilityversion)
* [<span data-ttu-id="feff3-269">전송 구성</span><span class="sxs-lookup"><span data-stu-id="feff3-269">Transport configuration</span></span>](xref:fundamentals/servers/kestrel#transport-configuration)
